<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="http://localhost:1313/docs/product/">
<link rel="alternate" type="application/rss&#43;xml" href="http://localhost:1313/docs/product/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<title>Product | Goldydocs</title>
<meta name="description" content="Already installed? Play us a song, Navidrome!">
<meta property="og:url" content="http://localhost:1313/docs/product/">
  <meta property="og:site_name" content="Goldydocs">
  <meta property="og:title" content="Product">
  <meta property="og:description" content="Already installed? Play us a song, Navidrome!">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Product">
  <meta itemprop="description" content="Already installed? Play us a song, Navidrome!">
  <meta itemprop="datePublished" content="2024-10-16T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-10-16T00:00:00+00:00">
  <meta itemprop="wordCount" content="1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Product">
  <meta name="twitter:description" content="Already installed? Play us a song, Navidrome!">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Layer_1" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512"><path style="fill:#0084ff" d="M256 10.449C120.275 10.449 10.449 120.276 10.449 256c0 135.725 109.826 245.551 245.551 245.551S501.551 391.725 501.551 256C501.551 120.276 391.725 10.449 256 10.449z"/><path style="fill:#fff" d="M256 168.229c-48.515.0-87.771 39.257-87.771 87.771s39.257 87.771 87.771 87.771 87.771-39.257 87.771-87.771S304.515 168.229 256 168.229z"/><path d="M437.061 74.94C388.735 26.615 324.434.0 256 0S123.265 26.615 74.939 74.94.0 187.566.0 256s26.614 132.735 74.939 181.061S187.566 512 256 512s132.735-26.614 181.061-74.939S512 324.434 512 256 485.386 123.266 437.061 74.94zM256 491.102C126.365 491.102 20.898 385.635 20.898 256S126.365 20.898 256 20.898 491.102 126.365 491.102 256 385.635 491.102 256 491.102z"/><path d="M354.22 256c0-54.158-44.061-98.22-98.22-98.22s-98.22 44.062-98.22 98.22 44.062 98.22 98.22 98.22 98.22-44.061 98.22-98.22zm-175.542.0c0-42.636 34.686-77.322 77.322-77.322s77.322 34.686 77.322 77.322S298.636 333.322 256 333.322 178.678 298.636 178.678 256z"/><path d="M285.257 256c0-16.132-13.124-29.257-29.257-29.257S226.743 239.868 226.743 256s13.125 29.257 29.257 29.257S285.257 272.133 285.257 256zm-37.616.0c0-4.609 3.75-8.359 8.359-8.359 4.609.0 8.359 3.75 8.359 8.359.0 4.609-3.75 8.359-8.359 8.359C251.391 264.359 247.641 260.609 247.641 256z"/><path d="M256 391.837c-5.771.0-10.449 4.678-10.449 10.449s4.678 10.449 10.449 10.449c41.897.0 81.265-16.294 110.853-45.883 29.587-29.587 45.881-68.955 45.881-110.852.0-5.771-4.678-10.449-10.449-10.449s-10.449 4.678-10.449 10.449C391.837 330.9 330.9 391.837 256 391.837z"/><path d="M449.306 245.551c-5.771.0-10.449 4.678-10.449 10.449.0 1.481-.018 2.958-.052 4.43-.136 5.769 4.43 10.557 10.199 10.692.085.002.168.003.252.003 5.656.0 10.307-4.517 10.442-10.202.039-1.637.059-3.279.059-4.925C459.755 250.229 455.077 245.551 449.306 245.551z"/><path d="M447.55 284.239c-5.656-1.145-11.168 2.52-12.308 8.178-17.107 84.854-92.489 146.44-179.242 146.44-5.771.0-10.449 4.678-10.449 10.449s4.678 10.449 10.449 10.449c47.353.0 93.467-16.573 129.847-46.668 35.9-29.697 60.717-71.084 69.881-116.54C456.868 290.891 453.207 285.38 447.55 284.239z"/><path d="M256 120.163c5.771.0 10.449-4.678 10.449-10.449S261.771 99.265 256 99.265c-41.897.0-81.265 16.294-110.853 45.883C115.559 174.735 99.265 214.103 99.265 256c0 5.771 4.678 10.449 10.449 10.449s10.449-4.678 10.449-10.449c0-74.9 60.937-135.837 135.837-135.837z"/><path d="M62.996 240.876c-5.759-.14-10.557 4.43-10.692 10.199-.039 1.637-.059 3.279-.059 4.925.0 5.771 4.678 10.449 10.449 10.449S73.143 261.771 73.143 256c0-1.481.018-2.958.052-4.43C73.331 245.8 68.765 241.013 62.996 240.876z"/><path d="M256 73.143c5.771.0 10.449-4.678 10.449-10.449S261.771 52.245 256 52.245c-47.353.0-93.467 16.573-129.847 46.668-35.9 29.697-60.717 71.084-69.881 116.54-1.14 5.657 2.521 11.168 8.178 12.308.697.141 1.392.208 2.076.208 4.872.0 9.232-3.426 10.232-8.386C93.864 134.729 169.247 73.143 256 73.143z"/></svg></span><span class="navbar-brand__name">Goldydocs</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/about/"><span>About</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/demo/"><span>Demo</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/docs/"><span>Documentation</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/community/"><span>Community</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/product/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Product</h1>
<div class="lead">Already installed? Play us a song, Navidrome!</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-ee77a023a61213303fbb63f2eb8cbfed">influxdb</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-d5a5e5bbe84fd32ba3551be3fd85ce9f">How-to-get-started</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-99731d6306341b7cb972dc1c730de812">Vew-data-in-vs-code</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-8ff84e2dc1250c8008b66811c0ec75c3">K-Spice</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-50d75d7a73d6c486a311e9e53e3d9360">How-to-install-kspice-python-connector</a></li>


    
  
    
    
	
<li>2.2: <a href="#pg-061d22f88cbadd9024b34fc7dec17e8b">How-to-save-snapshot-with-customized-name</a></li>


    
  
    
    
	
<li>2.3: <a href="#pg-b1b1b5f1c6c201ae80e3c388cd7de3b3">httplink-hints</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-500845087328a1b3c41c905a9dacb0e8">Kognitwin</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-5cfe444491a08f02e5a0a891227f9b0d">Generating realtime data</a></li>


    
  
    
    
	
<li>3.2: <a href="#pg-f957b6fbfc30336e6aa45280f2775ef5">infra</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.2.1: <a href="#pg-03ef388e5a9c058e31b9f763dfba06eb">镜像部署check list</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.3: <a href="#pg-1d39ea01b9abae19b413ef1a50a1c1bd">How to Run LNG in Local Environment</a></li>


    
  
    
    
	
<li>3.4: <a href="#pg-2f89a39e8ea369e6ec61ba8e431a32a9">Kognitwin-onboarding</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.4.1: <a href="#pg-f78066e1307ef209e00053883f6e5267">EDW Import from scratch</a></li>


    
  
    
    
	
<li>3.4.2: <a href="#pg-4c9ae92108c76e337bc5487565de27a6">How to set up Postman to connect tencent dev poc environment</a></li>


    
  
    
    
	
<li>3.4.3: <a href="#pg-d541abc8280a7042fd9dd14e51483e50">Huldra Import (Import a 3D Model) from scratch</a></li>


    
  
    
    
	
<li>3.4.4: <a href="#pg-5ed87020ecb0b63d6f59bf920893cedf">Getting Started</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3.4.5: <a href="#pg-63ee5e25dc8257d8c976dca5de7689ec">README</a></li>


    
  
    
    
	
<li>3.4.6: <a href="#pg-1245899f63a4ffa97d090256d494b0f5">edw links to pnid</a></li>


    
  
    
    
	
<li>3.4.7: <a href="#pg-4542ff5968d7940b9daab95e82cc17b0">importPnID</a></li>


    
  
    
    
	
<li>3.4.8: <a href="#pg-d63df6df16fd8b87381a8f48c7f4a0c2">influxdb emission management depoly tencent poc</a></li>


    
  
    
    
	
<li>3.4.9: <a href="#pg-24acc9c1174c2cb765606755caded7b0">influxdb emission management</a></li>


    
  
    
    
	
<li>3.4.10: <a href="#pg-439b695878e5a3c4d11470faccac60e9">pnid import from scratch</a></li>


    
  
    
    
	
<li>3.4.11: <a href="#pg-06f844956fb47e609af610cee866eb80">关于Week1 </a></li>


    
  
    
    
	
<li>3.4.12: <a href="#pg-619de057a11d795fc775647745575bb3">关于Week2</a></li>


    
  
    
    
	
<li>3.4.13: <a href="#pg-0823f0f68ea4e493d0992fe1ac4329b2">配置timeseries </a></li>


    
  

    </ul>
    
  
    
    
	
<li>3.5: <a href="#pg-5e04e82d59dd64c709218e466763306d">How to backup and restore mongodb</a></li>


    
  
    
    
	
<li>3.6: <a href="#pg-da18efafe95dd565746a4a2a54eaea51">tips</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.6.1: <a href="#pg-49b8822dfaadecebbf288ba008e230d5">How-to-solve-npm-i-e401</a></li>


    
  
    
    
	
<li>3.6.2: <a href="#pg-c2382f743f3d7590497793b51d3d461f">HowtodebugNodeJs</a></li>


    
  
    
    
	
<li>3.6.3: <a href="#pg-dfdb9907489fe3081f807e4872a4bde5">Howto查看MongoDB数据库内容</a></li>


    
  
    
    
	
<li>3.6.4: <a href="#pg-c7a8010dca5aa6f5bb7f2ab8ed8864aa"></a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  
    
    
	
<li>3.7: <a href="#pg-d5e30396fab17ba34e033352dc98027b">How to create node-opcua server image</a></li>


    
  
    
    
	
<li>3.8: <a href="#pg-5769c44e8012021889e80f7246cd34c7">How to create user and roles</a></li>


    
  
    
    
	
<li>3.9: <a href="#pg-7e2cce1514d77d89e3ae0f9c7b47bf30">How to deploy to another environment</a></li>


    
  
    
    
	
<li>3.10: <a href="#pg-ae221b96ece5a1a374f214b5983b5efe">How to run Kognitwin using Rancher Desktop</a></li>


    
  
    
    
	
<li>3.11: <a href="#pg-db930a25fb0a3e933662e91c73a92585">How to send messges</a></li>


    
  
    
    
	
<li>3.12: <a href="#pg-189dd23aaee9af6f7cc53989c4a47fb8">How to set up search feature</a></li>


    
  
    
    
	
<li>3.13: <a href="#pg-bfa904d913affc553bce389e98983813">How to use OpenDialog in realtime calculator</a></li>


    
  
    
    
	
<li>3.14: <a href="#pg-b4d5a2ef5f85b831ad6ab5767fb66df0">KTW deploys Lingque Cloud</a></li>


    
  
    
    
	
<li>3.15: <a href="#pg-9b81d83ff3edb23b65b45ba52baaec88">README</a></li>


    
  
    
    
	
<li>3.16: <a href="#pg-c6b74741a0ec7c8de12625b0b25659b6">TerraForm</a></li>


    
  
    
    
	
<li>3.17: <a href="#pg-be9bcc55d8540fe680f7bfc8d50a8829">how to setup timeseries </a></li>


    
  
    
    
	
<li>3.18: <a href="#pg-dd0691b93c7463d6e2988ce25061a4b8">how-to-set-camera-focus-prop-in-v3d</a></li>


    
  
    
    
	
<li>3.19: <a href="#pg-c13b1511c5247efb1ff5057480e03c36">ktw transfer from dev.poc to dev</a></li>


    
  
    
    
	
<li>3.20: <a href="#pg-1cb3afda006c016ee681b3ed8d50b107">realtime calculator</a></li>


    
  
    
    
	
<li>3.21: <a href="#pg-e540ef25ef9e18ee85d9656ace2b8280">run lng-python-logic 遇到的一些问题记录</a></li>


    
  
    
    
	
<li>3.22: <a href="#pg-30e2b21c4655c9df48acee02c6541aff">switch to realtime view</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      <p>开始分享吧</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-ee77a023a61213303fbb63f2eb8cbfed">1 - influxdb</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-d5a5e5bbe84fd32ba3551be3fd85ce9f">1.1 - How-to-get-started</h1>
    
	<ol>
<li>Run
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#000">docker</span> <span style="color:#000">run</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">d</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">p</span> <span style="color:#000">8086</span>:<span style="color:#204a87;font-weight:bold">8086</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">e</span> <span style="color:#000">DOCKER_INFLUXDB_INIT_MODE</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">setup</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">e</span> <span style="color:#000">DOCKER_INFLUXDB_INIT_USERNAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">my</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">user</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">e</span> <span style="color:#000">DOCKER_INFLUXDB_INIT_PASSWORD</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">my</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">password</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">e</span> <span style="color:#000">DOCKER_INFLUXDB_INIT_ORG</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">my</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">org</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">e</span> <span style="color:#000">DOCKER_INFLUXDB_INIT_BUCKET</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">my</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">bucket</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">e</span> <span style="color:#000">DOCKER_INFLUXDB_INIT_ADMIN_TOKEN</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">my</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#204a87;font-weight:bold">super</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">secret</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">auth</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">token</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">--</span><span style="color:#000">restart</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">always</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">--</span><span style="color:#000">name</span> <span style="color:#000">influxdb275</span> <span style="color:#ce5c00;font-weight:bold">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">influxdb</span>:<span style="color:#204a87;font-weight:bold">2.7.5</span>
</span></span></code></pre></div></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-99731d6306341b7cb972dc1c730de812">1.2 - Vew-data-in-vs-code</h1>
    
	<ol>
<li>Download and install the <a href="https://marketplace.visualstudio.com/items?itemName=influxdata.flux">Flux</a> extension.
<img alt="picture 0" src="/docs/Product/influxdb/Vew-data-in-vs-code_2024_03_13_14_57_3.png"></li>
<li>Add influxdb connection by clicking the <img alt="picture 2" src="/docs/Product/influxdb/Vew-data-in-vs-code_2024_03_13_14_59_3.png"> button: <br>
<img alt="picture 1" src="/docs/Product/influxdb/Vew-data-in-vs-code_2024_03_13_14_58_4.png"></li>
</ol>
<ul>
<li>Take LNG for example, Try the demo flux query:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bucket</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;my-bucket&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">|&gt;</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">start</span>: <span style="color:#204a87;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">|&gt;</span> <span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">fn</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;_measurement&#34;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;config-data&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">|&gt;</span> <span style="color:#000">sort</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">desc</span>: <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">columns</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;_time&#34;</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ce5c00;font-weight:bold">|&gt;</span> <span style="color:#000">limit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span>: <span style="color:#204a87;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Click &ldquo;Run -&gt; Run without debugging&rdquo;:
One should get data like:
<img alt="picture 3" src="/docs/Product/influxdb/Vew-data-in-vs-code_2024_03_13_15_02_4.png"></p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8ff84e2dc1250c8008b66811c0ec75c3">2 - K-Spice</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-50d75d7a73d6c486a311e9e53e3d9360">2.1 - How-to-install-kspice-python-connector</h1>
    
	<ol>
<li>Unzip <a href="https://dbinsp.sharepoint.com/:u:/s/KDIASKDIChina-SolutionandDev/EYtGuZCm02NMgWHaTUZ3QsYBruDT8zaYs91a-Rz_zB8IbA?e=vqeOem">kspice.cp311-win_amd64.pyd.zip</a></li>
<li>Copy the unzipped file(kspice.cp311-win_amd64.pyd) to <code>C:\Program Files (x86)\Kongsberg\K-Spice\bin64</code></li>
<li>Set the variable <code>PYTHONPATH</code>: <code>C:/Program Files (x86)/Kongsberg/K-Spice/bin64</code>:</li>
</ol>
<ul>
<li><img alt="picture 0" src="/docs/Product/K-Spice/How-to-install-kspice-python-connector_2023_12_21_10_37_3.png"></li>
</ul>
<p>ref:</p>
<ul>
<li>Original old file: <a href="https://dbinsp.sharepoint.com/:b:/s/KDIASKDIChina-SolutionandDev/ETgnf73w2l5Cm5MwTsoKFVQB9efX8bYMKw2FrmyRuQzRxg?e=ZuNh2c">Python API - Getting Started - Overview.pdf</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-061d22f88cbadd9024b34fc7dec17e8b">2.2 - How-to-save-snapshot-with-customized-name</h1>
    
	<ol>
<li>Open <code>Postman</code> app in the PC(eg: Zhongfa007). Click the request(&ldquo;Open the request I have created&rdquo;) I have created.</li>
<li>Change the snapshot name to the one you want(better to match K-Spice style: <a href="https://developer.mozilla.org/en-US/docs/Glossary/Kebab_case">kebab-case</a> with all small letters)</li>
<li>Run K-Spice to a point where you want to save a snapshot. Click &ldquo;Send&rdquo; button in <code>Postman </code>.</li>
<li>Wait for K-Spice to save the snapshot. after a few seconds, the result will be shown in the Result part of <code>Postman</code> like below (make sure <code>&quot;saveSnapshot&quot;: true</code>):</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;controlSimulation&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;saveSnapshot&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p><img alt="picture 0" src="/docs/Product/K-Spice/How-to-save-snapshot-with-customized-name_2024_01_31_13_35_0.png">
5. As one can see, The snapshot with the set name has been saved.
<img alt="picture 1" src="/docs/Product/K-Spice/How-to-save-snapshot-with-customized-name_2024_01_31_13_35_3.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b1b1b5f1c6c201ae80e3c388cd7de3b3">2.3 - httplink-hints</h1>
    
	<p>Refer to <a href="https://dbinsp.sharepoint.com/:u:/s/KDIASKDIChina-SolutionandDev/EY6Ijz-KrCBNj0VmNXQTrfYBwonLo5TZgdwFr5Ge-gk_oQ?e=erzwA8">official help doc for v23.10</a>, Copied from &ldquo;C:\Program Files (x86)\Kongsberg\K-Spice\Documentation\SimLinks.Net&rdquo; after K-spice has been installed.</p>
<h2 id="tested--tunnelhost-http">Tested <code>-tunnelHost http://*</code></h2>
<ul>
<li>
<p><img alt="picture 2" src="/docs/Product/K-Spice/httplink-hints_2023_10_26_09_39_3.png"></p>
</li>
<li>
<p>Need to run K-Spice in admin mode in order to make the httpLink work in this case, otherwise error will occur when activating the timeline.</p>
</li>
<li>
<p><img alt="picture 1" src="/docs/Product/K-Spice/httplink-hints_2023_10_26_09_34_3.png"></p>
</li>
</ul>
<h2 id="tested-setvalue">Tested <code>setValue</code>:</h2>
<p><img alt="picture 0" src="/docs/Product/K-Spice/httplink-hints_2023_10_26_09_32_4.png"><br>
<img alt="picture 3" src="/docs/Product/K-Spice/httplink-hints_2023_10_26_09_40_3.png"></p>
<h3 id="todo">TODO:</h3>
<ul>
<li>Regarding <code>-tunnelHost http://*</code>, However, It is highly recommended to use IIS (Internet Information Services) or any other webserver for this purpose instead of setting this option.</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-500845087328a1b3c41c905a9dacb0e8">3 - Kognitwin</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-5cfe444491a08f02e5a0a891227f9b0d">3.1 - Generating realtime data</h1>
    
	<h1 id="objective---generating-realtime-data-to-influxdb">objective - Generating realtime data to influxdb</h1>
<ol>
<li>create task <code>pushDummyRealtimeValues</code> to generate realtime dummy data</li>
</ol>
<p>eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importPipeline</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;rt&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;cn:zilong:import:rt&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;Cn Zilong Rt Import Pipeline&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">tasks</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#39;id&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;push_dummy_realtime_values_emissions&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#39;task&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;pushDummyRealtimeValues&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">triggers</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// like /3 run for every 3 minutes
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#4e9a06">&#34;schedule&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;0 */3 * * * *&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#39;configuration&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;source&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;cn:zilong:rt&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;isTaskRunningDuration&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#39;seconds&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;intervalinMS&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">6000</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;forLast&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#39;minutes&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;tagList&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#39;tag&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;LAYER_WM100-EQUI&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#39;range&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#39;min&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#39;max&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;fromDate&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#39;toDate&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">   * Decide if we should:
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">   * - false: Break down the pipelines into tasks and run them individually. (default)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">   * - true: Post the pipeline as-is to the services.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">   * The default of not to post the pipeline is intentional, to prevent errors.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">   * pipeline?: boolean;
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">pipeline</span>: <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">});</span>
</span></span></code></pre></div><p>Note: importPipeline方法里的最后一个参数ImportPipelineOptions，把pipeline设置为true是为了 Post the pipeline as-is to the services，让frontend admin里的task pipelines能够自动生成一个pushDummyRealtimeValues的task。而task里的参数schedule能够让后台服务中运行一个cronjob定时任务，定时产生实时数据。这个参数不是必填项，一般是需要在服务中需要跑定时任务才添加。</p>
<p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-rt.ts">import-zilong-rt.ts</a></p>
<ol>
<li>Post the pipeline as-is to the services</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import -s cn:zilong -t rt -e <span style="color:#204a87">local</span>  
</span></span></code></pre></div><p><img alt="picture 1" src="/docsGenerating%20realtime%20data_2023_05_26_10_40_4.png"></p>
<p><img alt="picture 2" src="/docsGenerating%20realtime%20data_2023_05_26_10_40_1.png"></p>
<ol start="3">
<li>configuration里字段含义 &amp; triggers schedule crontab syntax</li>
</ol>
<ul>
<li>
<p>configuration里字段含义<br>
<a href="taskservice%5Ctasks%5CpushDummyRealtimeValues.ts">pushDummyRealtimeValues.ts</a></p>
</li>
<li>
<p>triggers schedule crontab syntax<br>
<a href="https://www.adminschoice.com/crontab-quick-reference">Crontab – Quick Reference</a></p>
</li>
</ul>
<p><a href="https://www.npmjs.com/package/cron-parser">cron-parser</a></p>
<h2 id="reference">reference</h2>
<ul>
<li>
<p><a href="https://internal.docs.kognitwin.com/docs/planning/foundation/generator-service/">Generator service</a></p>
</li>
<li>
<p><a href="https://internal.docs.kognitwin.com/docs/applications-features/applications/real_time_viewer/realtimeviewer/">Real-Time Viewer (RTV)</a></p>
</li>
<li>
<p><a href="https://internal.docs.kognitwin.com/docs/applications-features/applications/real_time_viewer/realtimeviewerusermanual/">User Manual for Real-Time Viewer</a></p>
</li>
<li>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/realtime-timeseries/timeseries/">timeseries</a></p>
</li>
<li>
<p><a href="https://kongsbergdigital.slack.com/archives/C03V1LDUAV6/p1678270027186449">realtime data</a></p>
</li>
<li>
<p><a href="https://dbinsp.sharepoint.com/:p:/s/KDIASDigitalTwinProductDevelopment/EbWObRE5WgpIqUHEbpU2lvoBZCqTxxqErbbLB8dJrwlbaw?e=tKP7sy">Task Framework​ Introduction​</a></p>
</li>
<li>
<p><a href="https://dbinsp.sharepoint.com/sites/KDIASDigitalTwinProductDevelopment/_layouts/15/stream.aspx?id=%2Fsites%2FKDIASDigitalTwinProductDevelopment%2FShared%20Documents%2FDev%2F80%20Kognitwin%20Docs%20(Documentation%20and%20Academy)%2FVideos%2F2022-08%20Academy%20onboarding%20sessions%2FKognitwin%20Academy%20-%20Task%20Framework%20Introduction-20220812_100357-Meeting%20Recording.mp4">Task Framework​ Introduction video</a></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f957b6fbfc30336e6aa45280f2775ef5">3.2 - infra</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-03ef388e5a9c058e31b9f763dfba06eb">3.2.1 - 镜像部署check list</h1>
    
	<h3 id="twinservice-镜像"><code>twinservice</code> 镜像</h3>
<ul>
<li>部署完毕后，访问<code>https://THE_TWIN_URL/api/ready</code> 会显示 <code>ready</code>, 如：
<img alt="picture 1" src="/docs/Product/Kognitwin/infra%E9%95%9C%E5%83%8F%E9%83%A8%E7%BD%B2check%20list_2023_04_25_11_24_0.png"></li>
<li>该镜像的log不应该有<code>error</code>。</li>
</ul>
<h3 id="twin-镜像"><code>twin</code> 镜像</h3>
<ul>
<li>部署完毕后，浏览器打开Debugger, 找到包含<code>main.***.js</code>的请求并在新页面访问<code>https://THE_TWIN_URL/main.***.js</code>。确定其<code>status</code>是<code>200</code>，而且页面会显示该js， 该js大小约1Mb, 如：
<img alt="picture 3" src="/docs/Product/Kognitwin/infra/%E9%95%9C%E5%83%8F%E9%83%A8%E7%BD%B2check%20list_2023_04_25_11_31_3.png">。 请确保该页面的请求时间小于4s.</li>
</ul>
<h3 id="twinadmin-镜像"><code>twinadmin</code> 镜像</h3>
<ul>
<li>部署完毕后，浏览器打开Debugger, 找到包含<code>main..js</code>的请求并在新页面访问<code>https://THE_TWIN_ADMIN_URL/main..js</code>。确定其<code>status</code>是<code>200</code>，而且页面会显示该js， 该js大小约8Mb, 如：
<img alt="picture 5" src="/docs/Product/Kognitwin/infra%E9%95%9C%E5%83%8F%E9%83%A8%E7%BD%B2check%20list_2023_04_25_11_41_3.png">  。 请确保该页面的请求时间小于4s.</li>
<li>访问<code>https://poc.kognitwin.cn/api/files/</code> 确定其<code>status</code>是<code>200</code>，返回应是<code>array</code>
<img alt="picture 6" src="/docs/Product/Kognitwin/infra%E9%95%9C%E5%83%8F%E9%83%A8%E7%BD%B2check%20list_2023_04_25_11_44_4.png"></li>
</ul>
<h3 id="其他镜像请确保log没有错误">其他镜像请确保log没有错误</h3>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1d39ea01b9abae19b413ef1a50a1c1bd">3.3 - How to Run LNG in Local Environment</h1>
    
	<p>本地环境如何跑 LNG</p>
<ol>
<li>
<p>poetry &gt;=1.2.2  Install poetry from <a href="https://python-poetry.org/docs/#installing-with-the-official-installer">official docs</a></p>
<p>run <code>(Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | python -</code> in Windows (Powershell)</p>
<p><img alt="picture 0" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_02_41_3.png"></p>
<p>tip: Python &gt;=3.8.1  如何安装 &amp; 切换 Python 版本可参考条目 5.5</p>
</li>
<li>
<p>run <code>poetry install</code> under c/repos/Twin/taskworkers/lng-workers/simulation-worker</p>
<p><img alt="picture 1" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_03_27_1.png"></p>
</li>
<li>
<p><code>poetry run runMain</code> under c/repos/Twin/taskworkers/lng-workers/simulation-worker</p>
<p><img alt="picture 2" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_03_30_1.png"></p>
</li>
<li>
<p>install <a href="https://github.com/pyenv-win/pyenv-win">https://github.com/pyenv-win/pyenv-win</a></p>
<p>run <code>pip install pyenv-win --target %USERPROFILE%\\.pyenv</code></p>
<p><img alt="picture 3" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_05_43_4.png"></p>
<p>tip: <code>pip</code> 可以随安装 python 一起安装</p>
<p><img alt="picture 5" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_06_19_1.png"></p>
</li>
<li>
<p>run <a href="https://kdic.coding.net/p/lngzhuhaijiangsu/d/lng-python-logic/git/tree/master/rpyc/rpyc-server.py">https://kdic.coding.net/p/lngzhuhaijiangsu/d/lng-python-logic/git/tree/master/rpyc/rpyc-server.py</a></p>
<p>5.1 run <code>pip install rpyc</code></p>
<p><img alt="picture 4" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_05_53_4.png"></p>
<p>5.2 install k-spice and 模型</p>
<pre><code> [k-spice](https://dbinsp-my.sharepoint.com/:u:/g/personal/changli_hao_kongsbergdigital_com/EeXoAhAFWCpOn1FE3ggfjC0BIYFPYkQoeX-NdxJF0yIDuw?e=mUjkkb)

 [模型](https://dbinsp-my.sharepoint.com/:u:/g/personal/changli_hao_kongsbergdigital_com/EXSZ4zXwudZEo7tj1cP5yp4BRzdafq2l1a9l53fibb8WCw?e=HRRSCh)
</code></pre>
<p>5.3 download <a href="https://dbinsp-my.sharepoint.com/:u:/g/personal/long_cui_kongsbergdigital_com/ERVMYsvx3ElPtMtFy4QgnCYBLw52x-Yhx9q2sqdOEIOMqQ?e=fvc5f1">kspice.cp11-win_amd64.pyd</a></p>
<p>5.4 paste it to K-Spice install bin64</p>
<pre><code> `C:\Program Files (x86)\Kongsberg\K-Spice\bin64`

 ref: [Python API - Getting Started](https://dbinsp-my.sharepoint.com/:b:/g/personal/long_cui_kongsbergdigital_com/ESRrhvkWKYdAvbaknzlfiQ4Bi_q2Xj6AWg6H7bBh8gHecQ?e=ZBOjkm)
</code></pre>
<p><img alt="picture 9" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_12_07_55_1.png"></p>
<p>5.5 switch python version to 3.11</p>
<pre><code> run `pyenv install -l` to check a list of Python versions supported by pyenv-win
</code></pre>
<p><img alt="picture 6" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_06_26_3.png"></p>
<pre><code> run `pyenv install 3.11.0a1` to install the supported version

 run `pyenv local 3.11.0a1` to set the local application-specific python version
</code></pre>
<p><img alt="picture 7" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_06_28_2.png"></p>
<p>5.6 run <code>python rpyc\rpyc-server.py</code> under C:\projects\lng-python-logic</p>
<p><img alt="picture 8" src="/docs%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E8%B7%91%20LNG_2023_12_11_06_31_3.png"></p>
</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2f89a39e8ea369e6ec61ba8e431a32a9">3.4 - Kognitwin-onboarding</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-f78066e1307ef209e00053883f6e5267">3.4.1 - EDW Import from scratch</h1>
    
	<h1 id="目标---edw-import-and-search-config-from-scratch">目标 - EDW Import and search config from scratch</h1>
<ol>
<li>
<p>下载数据
<a href="https://dbinsp.sharepoint.com/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Forms/AllItems.aspx?csf=1&web=1&e=YsdA7R&xsdata=MDV8MDF8fDliOWRlZmJhOTEwMDQ4MDZkNjNkMDhkYjQzYTk3NWJlfGJmN2NiODcwYjM3ODQyYWJhNjE4MzE3MDRiYzJlOWI3fDB8MHw2MzgxNzgxNjczMDcwMzIxMjV8VW5rbm93bnxWR1ZoYlhOVFpXTjFjbWwwZVZObGNuWnBZMlY4ZXlKV0lqb2lNQzR3TGpBd01EQWlMQ0pRSWpvaVYybHVNeklpTENKQlRpSTZJazkwYUdWeUlpd2lWMVFpT2pFeGZRPT18MXxNVFk0TWpJeE9Ua3lPVFUxTXpzeE5qZ3lNakU1T1RJNU5UVXpPekU1T2pBME5HWXlaakExTFRZNVpqSXROR1E1TmkwNU9EWmpMVE16TXpBeVkyTTBZekExTUY4NFl6QmtPVFk1TXkwd1lXSmtMVFEzTXpndE9HWXdNaTFqTWpBeVlqWXlOalZtWmpOQWRXNXhMbWRpYkM1emNHRmpaWE09fGFjZjVlNzk1NzEyZTRiNzRkNjNkMDhkYjQzYTk3NWJlfDQxOGE1YzJmZTFiYjQ2Y2Y5YmI1MGJiMDgwNmQ5NGEw&sdata=TkhjRGxqR0NyVFJFdTQ0ZjhuQmYzTXErdUM4Wkt6YnZZNWtnUGtaS3p5UT0%3D&ovuser=bf7cb870%2Db378%2D42ab%2Da618%2D31704bc2e9b7%2Czilong%2Epan%40kongsbergdigital%2Ecom&OR=Teams%2DHL&CT=1682219954490&clickparams=eyJBcHBOYW1lIjoiVGVhbXMtRGVza3RvcCIsIkFwcFZlcnNpb24iOiIyNy8yMzAzMDUwMTExMCIsIkhhc0ZlZGVyYXRlZFVzZXIiOmZhbHNlfQ%3D%3D&cid=6a47d620%2Dcc5d%2D4b2c%2Dae9b%2Daea9b05280b3&RootFolder=%2Fsites%2FKDIASKDIChina%2DSolutionandDev%2FShared%20Documents%2FSolution%20and%20Dev%2F11%5FDev%2FKTW%20onboarding%2FCogs%2FKDI%2Fcn%2Fhello%2Fedw&FolderCTID=0x01200089693E4F68F4B445859EF8F504B678E9">EDW</a></p>
</li>
<li>
<p>Put the files into local folder
<code>C:\Cogs\KDI\cn\zilong\edw</code></p>
</li>
<li>
<p>ktw add source</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add <span style="color:#204a87">source</span> cn:zilong:edw  
</span></span></code></pre></div><ol start="4">
<li>
<p>修改import-zilong-edw.ts， importPipeline添加任务 - importEdw<br>
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-edw.ts">import-zilong-edw.ts</a></p>
</li>
<li>
<p>search index 配置 <code>&quot;cn:zilong:edw:tag&quot;</code> and <code>&quot;cn:zilong:edw:doc&quot;</code> in hello-projects.json<br>
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/hello-projects.json">hello-projects.json</a></p>
</li>
<li>
<p>import EDW to mongdb</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s cn:zilong -t edw
</span></span></code></pre></div><ol start="7">
<li>mongdb查看结果</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#000">db</span> <span style="color:#ce5c00;font-weight:bold">=</span> db.getSiblingDB<span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;twin&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>db.getCollection<span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;assets&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>.find<span style="color:#ce5c00;font-weight:bold">({</span>source: <span style="color:#4e9a06">&#39;cn:zilong:edw&#39;</span><span style="color:#ce5c00;font-weight:bold">})</span><span style="color:#000;font-weight:bold">;</span>
</span></span></code></pre></div><p><img alt="mongdb查看结果" src="/docs/Product/Kognitwin/Kognitwin-onboardingEDW%20Import%20from%20scratch_2023_04_25_14_27_3.png"></p>
<ol start="8">
<li>import configuration file for search features</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#4e9a06">\T</span>win.hello&gt;ktw import hello-projects.json
</span></span></code></pre></div><ol start="9">
<li>访问<a href="http://localhost:4200/cn:zilong:main">localhost</a></li>
</ol>
<p><img alt="search Document 效果图" src="/docs/Product/Kognitwin/Kognitwin-onboardingEDW%20Import%20from%20scratch_2023_04_25_14_34_2.png"></p>
<p><img alt="search Tag 效果图" src="/docs/Product/Kognitwin/Kognitwin-onboardingEDW%20Import%20from%20scratch_2023_04_25_14_35_1.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4c9ae92108c76e337bc5487565de27a6">3.4.2 - How to set up Postman to connect tencent dev poc environment</h1>
    
	<h1 id="objective---how-to-set-up-postman-to-connect-tencent-dev-poc-environment">objective - How to set up Postman to connect tencent dev poc environment</h1>
<ol>
<li>
<p>Download it from <a href="https://www.postman.com/downloads/">postman</a></p>
</li>
<li>
<p>Collection with authentication configuration
Download the default authorized collection json-file: <a href="https://internal.docs.kognitwin.com/docs/development/getting_started/tools/tools/postman/TwinAuthorized.postman_collection.json">TwinAuthorized.postman_collection.json</a></p>
</li>
<li>
<p>In the Postman toolbar, click the Import button</p>
</li>
<li>
<p>set variables</p>
</li>
</ol>
<ul>
<li>baseAuthUrl: <a href="https://auth.ops.kognitwin.cn">https://auth.ops.kognitwin.cn</a></li>
<li>tenantId: dev-poc</li>
<li>clientId: twin-frontend</li>
<li>realm: dev-poc</li>
<li>baseUrl: <a href="https://dev.poc.kognitwin.cn/api">https://dev.poc.kognitwin.cn/api</a></li>
</ul>
<p><img alt="picture 1" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_11_2.png"></p>
<ol start="5">
<li>config authorization - configure new token</li>
</ol>
<ul>
<li>Grant Type: Authorization Code</li>
<li>Callback URL: <a href="https://dev.poc.kognitwin.cn/">https://dev.poc.kognitwin.cn/</a></li>
<li>Auth URL: {{baseAuthUrl}}/realms/{{realm}}/protocol/openid-connect/auth</li>
<li>Access Token URL: {{baseAuthUrl}}/realms/dev-poc/protocol/openid-connect/token</li>
<li>Scope: openid</li>
</ul>
<p><img alt="picture 4" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_44_3.png"></p>
<ol start="6">
<li>click the &lsquo;Get New Access Token&rsquo; button, Enter your email and credentials (if required) and continue the login formalities</li>
</ol>
<p><img alt="picture 2" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_34_2.png"></p>
<p><img alt="picture 3" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_34_4.png"></p>
<ol start="7">
<li>Press the &lsquo;Use Token&rsquo; button</li>
</ol>
<p><img alt="picture 7" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_58_3.png"></p>
<p><img alt="picture 5" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_50_0.png"></p>
<ol start="8">
<li>get assets</li>
</ol>
<p><img alt="picture 6" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_51_0.png"></p>
<ol start="9">
<li>get timeseries</li>
</ol>
<p><img alt="picture 8" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_14_59_1.png"></p>
<ol start="10">
<li>post timeseries</li>
</ol>
<p><img alt="picture 9" src="/docs/Product/Kognitwin/Kognitwin-onboardingHow%20to%20set%20up%20Postman_2023_05_17_15_02_0.png"></p>
<h1 id="reference">reference</h1>
<ul>
<li>
<p><a href="https://internal.docs.kognitwin.com/docs/development/getting_started/tools/tools/postman/">internal doc postman</a></p>
</li>
<li>
<p><a href="https://auth.ops.kognitwin.cn/realms/dev-poc/protocol/openid-connect/auth?response_type=code&client_id=twin-frontend&state=WUd5X2FRcjhoTDFpS3JRc3VzdDE1ZWdDUlBUYVIybjd5Q2ttUWdORVREbGUu%3Bhttps%253A%252F%252Fdev.poc.kognitwin.cn%252F&redirect_uri=https%3A%2F%2Fdev.poc.kognitwin.cn&scope=openid%20offline_access&code_challenge=SBJ5ve4nmCBD6CQn47tVTky1I0cWpivFuThZSewIYVw&code_challenge_method=S256&nonce=WUd5X2FRcjhoTDFpS3JRc3VzdDE1ZWdDUlBUYVIybjd5Q2ttUWdORVREbGUu">auth url</a></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d541abc8280a7042fd9dd14e51483e50">3.4.3 - Huldra Import (Import a 3D Model) from scratch</h1>
    
	<h1 id="目标---huldra-import-import-a-3d-model-from-scratch">目标 - Huldra Import (Import a 3D Model) from scratch</h1>
<ol>
<li>Install Kognitwin CLI - ktw</li>
</ol>
<p><a href="https://kdic.coding.net/p/kdi-twin/d/Twin/git/tree/development/cli#user-content-local-build">Local build</a><br>
you can automatically build and install the CLI using the <code>cli</code> script in the Twin repository:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>Twin&gt; npm run cli
</span></span></code></pre></div><ol start="2">
<li>Create new workspace using Kognitwin CLI</li>
</ol>
<p>2.1 Create a new workspace hello using template hello in local folder /tutorial. You can use whatever you want as the local folder.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>mkdir /tutorial
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> /tutorial
</span></span><span style="display:flex;"><span>ktw new workspace hello --template hello
</span></span></code></pre></div><p>2.2 Change your working directory to this subfolder to ensure you are running the next ktw commands from this folder.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> /tutorial/hello
</span></span></code></pre></div><p>2.3 To show information about the new workspace you can use the command</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw info
</span></span></code></pre></div><p>2.4 参考repo <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong?tab=file">hello</a></p>
<ol start="3">
<li>Create folderstucture</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>C:<span style="color:#4e9a06">\C</span>ogs<span style="color:#4e9a06">\K</span>DI<span style="color:#4e9a06">\c</span>n<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\h</span>ul
</span></span></code></pre></div><ol start="4">
<li>
<p>Download data to your huldra directory
<a href="https://dbinsp.sharepoint.com/:f:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/Cogs/KDI/cn/zilong/hul?csf=1&web=1&e=e8zl9P">Sample Data</a>
Download data and put the data inside <code>C:\Cogs\KDI\cn\zilong\hul</code></p>
</li>
<li>
<p>Download textures to your Twin server files
<a href="https://dbinsp.sharepoint.com/:f:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/twin-view?csf=1&web=1&e=hlBICN">Sample Data</a><br>
Download all the files here and unpack them into your <code>C:/&lt;yourOwnPathHere&gt;/Twin/server/files/twin-view</code> folder. If the folder structure does not exist, please create it.
The resulting path to one of the items should look like this: <code>C:/&lt;yourOwnPathHere&gt;/Twin/server/files/twin-view/qwantani_cubemap_irradiance_nosun_64.dds.zst</code>.</p>
</li>
<li>
<p>Make sure the .env file is correctly pointing to the import service in your local Twin. Basically verify that the variables correspond with the files/paths on your local PC.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#000">TWIN_IMPORT_SERVICE_PATH</span><span style="color:#ce5c00;font-weight:bold">=</span>C:<span style="color:#4e9a06">\r</span>epa<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\i</span>mport<span style="color:#4e9a06">\d</span>ist<span style="color:#4e9a06">\i</span>mport
</span></span><span style="display:flex;"><span><span style="color:#000">TWIN_IMPORT_BASE</span><span style="color:#ce5c00;font-weight:bold">=</span>C:/Cogs/KDI
</span></span><span style="display:flex;"><span><span style="color:#000">BINARY_SEARCH_PATHS</span><span style="color:#ce5c00;font-weight:bold">=</span>C:<span style="color:#4e9a06">\r</span>epa<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\n</span>ode_modules<span style="color:#4e9a06">\@</span>kognifai<span style="color:#4e9a06">\c</span>ogstools-windows-x64
</span></span><span style="display:flex;"><span><span style="color:#000">COGS_EXE</span><span style="color:#ce5c00;font-weight:bold">=</span>Cogs.Core.Runtime.exe
</span></span><span style="display:flex;"><span><span style="color:#000">RVMPARSER_EXE</span><span style="color:#ce5c00;font-weight:bold">=</span>RvmProc.exe
</span></span></code></pre></div><p><a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/.env?tab=file">.env</a></p>
<ol start="7">
<li>Making a new docker container</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker run --name twin-dev-zilong --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -p 27017:27017 -d mongo
</span></span></code></pre></div><p>Open .env in \Twin\server.env and change TWIN_DB_CONNECTION_STRING=mongodb://localhost:27017</p>
<ul>
<li>tips: 如果想重新创建一个mongodb，只需要改变一下端口号最后一位（这里是27015，比如可以改变成27014），然后再\Twin\server.env下修改相应的参数即可。</li>
</ul>
<ol start="8">
<li>在Twin.hello，通过CLI commands - ktw add的方式创建</li>
</ol>
<p>8.1 ktw add scope top-level adds a new scope called top-level to the global parent scope</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add scope cn
</span></span></code></pre></div><p>8.2 ktw add scope<br>
Subsequently running ktw add scope top-level:nested adds a new scope called nested, under the top-level scope.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add scope cn:zilong  
</span></span></code></pre></div><p>8.3 ktw add source</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add <span style="color:#204a87">source</span> cn:zilong:v3d  
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add <span style="color:#204a87">source</span> cn:zilong:v3d --type v3d --scope cn:zilong  
</span></span></code></pre></div><p>8.4 修改参数<br>
文件\Twin.hello\cn\zilong\import-zilong-v3d.ts中，修改inputDir，layers参数.<br>
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-v3d.ts">import-zilong-v3d.ts</a></p>
<p>8.5 ktw add feature<br>
参考文档<a href="https://internal.docs.kognitwin.com/docs/reference/cli/commands/add/add-feature/">ktw add feature</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add feature split-layout cn:zilong:main  
</span></span><span style="display:flex;"><span>ktw add feature twin-view cn:zilong:main  
</span></span><span style="display:flex;"><span>ktw add feature context-menu cn:zilong:main    
</span></span></code></pre></div><p>8.6 创建hul-scene.json</p>
<ul>
<li>修改参数id和source<br>
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/hul/hul-scene.json?tab=blame">hul-scene.json</a></li>
</ul>
<p>8.7 修改zilong-workflows-main.json</p>
<ul>
<li>
<p>添加参数parameters &amp; twinScene<br>
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-workflows-main.json">zilong-workflows-main.json</a></p>
</li>
<li>
<p>Note小技巧: 修改个别配置文件，可以直接通过ktw import + 相对路径的方式导入，并通过admin查看, 可以参考如下命令</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\z</span>ilong-workflows-main.json
</span></span><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\z</span>ilong-twin-view.json
</span></span></code></pre></div><p>8.8 修改zilong-twin-view.json</p>
<ul>
<li>在templates中修改参数defaultMaterialSet &amp; layers<br>
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-twin-view.json">zilong-twin-view.json</a></li>
</ul>
<ol start="9">
<li>Importing data<br>
Run the following imports:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s root
</span></span><span style="display:flex;"><span>ktw import -s cn:*
</span></span></code></pre></div><p>Check that you have the files in your twin/server/files/assets/hul
Open your <a href="http://localhost:4200/cn:zilong:main">localhost</a> and control that the 3D files are correct.</p>
<ol start="10">
<li>最终效果图<br>
<img alt="最终效果图" src="/docs/Product/Kognitwin/Kognitwin-onboardingHuldra%20Import%20(Import%20a%203D%20Model)%20from%20scratch_2023_04_25_13_01_1.png"></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5ed87020ecb0b63d6f59bf920893cedf">3.4.4 - Getting Started</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-63ee5e25dc8257d8c976dca5de7689ec">3.4.5 - README</h1>
    
	<h3 id="how-to">How to</h3>
<ol>
<li>根据 KDIC的 <a href="https://dbinsp.sharepoint.com/:x:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/Onboarding%20Plan.xlsx?d=w91986698b3bd4ff5abc913f8664926da&csf=1&web=1&e=kvlrNv">KDIC Onboarding Plan.xlsx</a> 的内容走，对于每一个week plan(就是每一个tab)，有一些补充信息，请参考， 如 <a href="/docs/product/kognitwin/kognitwin-onboarding/%E5%85%B3%E4%BA%8Eweek1/">关于Week1</a></li>
</ol>
<hr>
<h4 id="信息">信息</h4>
<ul>
<li>
<p>KTW 文档： <a href="https://internal.docs.kognitwin.com/">https://internal.docs.kognitwin.com/</a></p>
</li>
<li>
<p>KDI使用Slack答疑：https://internal.docs.kognitwin.com/academy/introduction/slack_onboarding/</p>
</li>
</ul>
<h4 id="软件环境">软件环境：</h4>
<ul>
<li>
<p>完整的Kognitwin产品，主要用来内外部测试演示，由KDI负责维护： <a href="https://dev.kdi.kognitwin.com/">https://dev.kdi.kognitwin.com/</a></p>
</li>
<li>
<p>完整的Kognitwin产品，主要是KDIC用来内外部测试演示，由KDIC负责维护：https://dev.poc.kognitwin.cn/</p>
</li>
</ul>
<h4 id="缩略词">缩略词：</h4>
<ul>
<li>
<p>KDIC: Kongsberg Digital China</p>
</li>
<li>
<p>KTW: Kognitwin</p>
</li>
</ul>
<h4 id="heading"></h4>
<p>ref:
<a href="https://dbinsp.sharepoint.com/:x:/r/sites/KDIASDigitalTwinProductDevelopment/_layouts/15/Doc.aspx?sourcedoc=%7BD93EBA35-5AF0-48CF-AD5C-74C485D914AC%7D&file=Onboarding%20Plan.xlsx&action=default&mobileredirect=true">Onboarding plan from KDI</a> (Kongsberg Digital)</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboardingb570104e-7e74-42e4-b432-a55dd5a42b3d.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1245899f63a4ffa97d090256d494b0f5">3.4.6 - edw links to pnid</h1>
    
	<h1 id="objective---edw-links-to-pnid">objective - edw links to pnid</h1>
<ol>
<li>
<p>create cn-context-menu.json
ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/global/templates/cn-context-menu.json">cn-context-menu.json</a></p>
</li>
<li>
<p>create template contextMenu in hello-projects.json
ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/hello-projects.json">hello-projects.json</a></p>
</li>
<li>
<p>some changes in zilong-workflows-main.json
3.1 change template context menu id - <code>&quot;id&quot;: &quot;cn:contextMenu&quot;</code><br>
3.2 add <code>&quot;slotsControlMode&quot;: &quot;implicit&quot;</code> in layout of content<br>
3.3 add document template in components</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;document&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;template&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;no:documentviewer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;defaultId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;-&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;componentId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;document&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;actionScope&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;document&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;navigationScope&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;document&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;messageSource&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;process-view&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;currentScope&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;oppositeScope&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;defaultNavMessagesOff&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;allowedToDrawAndEdit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-workflows-main.json">zilong-workflows-main.json</a></p>
<ol start="4">
<li>
<p>download edw (edw)[https://dbinsp.sharepoint.com/:f:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/Cogs/KDI/cn/hello/edw-zilong-onboarding?csf=1&amp;web=1&amp;e=KFAZeK]</p>
</li>
<li>
<p>Put the files into local folder
<code>C:\Cogs\KDI\cn\zilong\edw</code></p>
</li>
<li>
<p>import EDW to mongdb</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s cn:zilong -t edw -e <span style="color:#204a87">local</span>
</span></span></code></pre></div><ol start="7">
<li>result images</li>
</ol>
<p><img alt="Show in split view" src="/docs/Product/Kognitwin/Kognitwin-onboardingedw%20links%20to%20pnid_2023_05_08_15_13_4.png"></p>
<p><img alt="Show in split view" src="/docs/Product/Kognitwin/Kognitwin-onboardingedw%20links%20to%20pnid_2023_05_08_16_42_2.png"></p>
<p><img alt="open in new tab" src="/docs/Product/Kognitwin/Kognitwin-onboardingedw%20links%20to%20pnid_2023_05_08_16_43_0.png"></p>
<p><img alt="open in new tab" src="/docs/Product/Kognitwin/Kognitwin-onboardingedw%20links%20to%20pnid_2023_05_08_16_31_1.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4542ff5968d7940b9daab95e82cc17b0">3.4.7 - importPnID</h1>
    
	<h3 id="diagramparser">DiagramParser</h3>
<ul>
<li>Use the TestViewer in <a href="https://dbinsp.sharepoint.com/:u:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/Softwares/DiagramParser_22.09.12.1.7z?csf=1&web=1&e=1WC97A">internal viewer</a> to read PnID(we do not have access to Azure Devops)</li>
</ul>
<h3 id="get-familiar-with-testviewerhttpsinternaldocskognitwincomacademykognitwin_teamsexperience_teamsintegrationgetting_started_with_hotspot_identification"><a href="https://internal.docs.kognitwin.com/academy/kognitwin_teams/experience_teams/integration/getting_started_with_hotspot_identification/">Get familiar with TestViewer</a></h3>
<h3 id="how-to-use-task-importdocuments-to-import-pnid">How to use task <code>importDocuments</code> to import pnid</h3>
<ul>
<li>Need to get <a href="https://imagemagick.org/archive/binaries/ImageMagick-7.1.1-6-portable-Q16-x86.zip">ImageMagic</a> dependency.</li>
<li>The <code>Configuration</code> in <a href="https://internal.docs.kognitwin.com/docs/development/tasks/import/pnid/">https://internal.docs.kognitwin.com/docs/development/tasks/import/pnid/</a> could be auto generated by:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#000">ktw</span> <span style="color:#000">add</span> <span style="color:#000">scope</span> <span style="color:#000">cn</span>:<span style="color:#204a87;font-weight:bold">hello</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ktw</span> <span style="color:#000">add</span> <span style="color:#000">source</span> <span style="color:#000">cn</span>:<span style="color:#204a87;font-weight:bold">hello</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">pnid</span>
</span></span></code></pre></div><ul>
<li>One needs to understand the finder.json which is a must-to-have file to config what to ipmort to mongoDB. <a href="https://internal.docs.kognitwin.com/academy/kognitwin_teams/experience_teams/integration/finderdef_examples/">finderdef_examples</a></li>
</ul>
<h3 id="目标1pdf导入mongodb"><strong>目标1：pdf导入mongodb</strong></h3>
<ol>
<li>下载pdf文件。</li>
</ol>
<p>Keep only <code>1301-PWells_1-4.pdf</code> and <code>1301-PWells_5-8.pdf</code> under eg:<code>C:\Cogs\KDI\Country\Demo\sources\pdfs</code>.</p>
<p><a href="https://dbinsp.sharepoint.com/:b:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/importPnid/1301-PWells_1-4.pdf?csf=1&web=1&e=PUH929">1301-PWells_1-4.pdf</a></p>
<p><a href="https://dbinsp.sharepoint.com/:b:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/importPnid/1301-PWells_5-8.pdf?csf=1&web=1&e=4MyCuC">1301-PWells_5-8.pdf</a></p>
<ol start="2">
<li>创建正则表达式以标注pdf文件<br>
C:\Cogs\KDI\Country\Demo\configs\demoFinder.json</li>
</ol>
<p><a href="https://dbinsp.sharepoint.com/sites/KDIASKDIChina-SolutionandDev/_layouts/15/download.aspx?UniqueId=3e8a28c1fae542abbf493361993fa88e&e=uoVhgd">demoFinder.json</a></p>
<ol start="3">
<li>
<p>更新import pnid脚本文件的 analyzerConfig属性<br>
\Twin.KDI\country\demo\import-demo-pnid.ts</p>
</li>
<li>
<p>把已标注的pdf文件导入mongdb<br>
ktw import -s country:* -t pnid</p>
</li>
<li>
<p>在mongdb查看导入数据</p>
</li>
</ol>
<ul>
<li>query in 3T mongodb
twin &gt; assets &gt; intelliShell
db = db.getSiblingDB(&ldquo;twin&rdquo;);
db.getCollection(&ldquo;assets&rdquo;).find({source:&lsquo;country:demo:pnid&rsquo;});</li>
</ul>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboardingf9685355-e656-4078-bdbf-479f4ff3eb6c.png"></p>
<h3 id="目标2pdf文件在页面中显示出来">目标2：pdf文件在页面中显示出来</h3>
<ol>
<li>创建workflows</li>
</ol>
<p>1.1 \Twin.KDI\country\demo\demo-pnid-workflows-test.json
1.2 \Twin.KDI\country\demo\demo-pnid-no-documentviewer.json</p>
<p>note: 关联过程
workflows -&gt; tencent poc admin - workflows -&gt; router - no:document -&gt;
\Twin.Tencent\deploymentWorkspace\importNYH\README.md -&gt;
参考\Twin.Shell\no\workflows\no-document-workflows.json 创建了demo-pnid-workflows-test.json -&gt; 参考\Twin.Shell\no\nyh\components\no-document-viewer.json 创建了demo-pnid-no-documentviewer.json</p>
<ol start="2">
<li>执行导入</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import country/demo/demo-pnid-workflows-test.json
</span></span><span style="display:flex;"><span>ktw import country/demo/demo-pnid-no-documentviewer.json
</span></span></code></pre></div><p>3 . 遇到报错并解决问题
3.1 template no:documentviewer missing parameter allowedToDrawAndEdit
add <code>&quot;allowedToDrawAndEdit&quot;: true</code> in demo-pnid-workflows-test.json</p>
<p>3.2 后台接口没有返回pdf
发现接口参数source里面没有相应的country:demo:pnid</p>
<p>(http://localhost:8080/assets?id=1301-PWells_1-4&amp;source=&hellip;)
通过source，找到配置queries - base - assets - source country\demo\demo-pnid-workflows-test.json</p>
<p>3.3 assets接口已经把pdf请求回来了， 但是并没有在页面中显示出来</p>
<ul>
<li>启动<a href="localhost:4201">admin</a>调试
在Twin.KDI中导入
ktw import admin/admin-projects.json
ktw import admin/admin-settings.json
ktw import admin/admin-templates.json
ktw import admin/admin-workflows.json</li>
<li>Twin repo 和 其他repo（Twin.KDI, hello, Twin.Shell, Twin.Tencent）的关系？
Twin - 总部开发的，可以理解为架子， 除了环境变量等配置文件，其他基本不用修改
其他repo - 部署用的， 通过import添加配置文件的方式, 用哪个都可以。比如：Twin.Shell - 壳牌， Twin.Tencent - Tencent</li>
<li>从左上角documentid没有显示入手，如何在Twin中查找前端源码</li>
</ul>
<ol>
<li>通过html标签 &lt;lib-process-view -&gt; &lt;lib-asset-info</li>
<li>发现组件asset info是通过容器组件process-view进行赋值
\Twin\client\projects\twin-components\src\lib\asset-info\asset-info.component.html
\Twin\client\projects\process-view\src\lib\process-view.component.html</li>
<li>在组件process-view - updateDisplayID方法中，赋值assetInfo。但是在本地环境中并没有走这个方法</li>
<li>顺着方法调用查找到，原来是卡在了是否合法参数校验中 - isParametersValid</li>
<li>通过参数scope，定位到配置文件demo-pnid-no-documentviewer.json -
&ldquo;scope&rdquo;: &ldquo;$(match($queries.base.dbSourceAsset,(country:demo):.*,1))&rdquo;
修改为对应的source即可。</li>
<li>整体思路（关联过程） html标签 -&gt; 源码组件 -&gt; 在浏览器进行方法调式 -&gt; 发现问题 -&gt; 在配置文件中定位问题，修改 -&gt; 再次import配置文件 -&gt; 再次验证</li>
</ol>
<p>效果图</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding4320937c-02e0-4675-b4c5-f6ba13633e48.png"></p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding5f42d98f-7307-4e49-8b01-8e3260164198.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d63df6df16fd8b87381a8f48c7f4a0c2">3.4.8 - influxdb emission management depoly tencent poc</h1>
    
	<h1 id="objective---deploy-emissions-management-in-tencent-poc">objective - deploy emissions management in tencent poc</h1>
<ol>
<li>add environment</li>
</ol>
<ul>
<li>tencent poc</li>
</ul>
<p>run <code>ktw add environment</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add environment t https://dev.poc.kognitwin.cn/api --idp<span style="color:#ce5c00;font-weight:bold">=</span>keycloak --tenantId dev-poc --clientId twin-devicelogin --authServerUrl https://auth.ops.kognitwin.cn/
</span></span></code></pre></div><ol start="2">
<li>import workflow</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\h</span>ello-workflows-emission-management.json -e t  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/hello-workflows-emission-management.json">hello-workflows-emission-management.json</a></p>
<ol start="3">
<li>import template</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\h</span>ello-templates-nz-emission-management.json -e t  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/hello-templates-nz-emission-management.json">hello-templates-nz-emission-management.json</a></p>
<ol start="4">
<li>change server influx host to <code>influxdb.default</code>, then import sources</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\z</span>ilong-rt.json -e t  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-rt.json">zilong-rt.json</a></p>
<ol start="5">
<li>Register the sensors</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\t</span>est-rta-assets.json -e t  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/test-rta-assets.json">test-rta-assets.json</a></p>
<ol start="6">
<li>Use task <code>pushDummyRealtimeValues</code> to generate dummy data</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import -s cn:zilong -t rt -e t  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-rt.ts">import-zilong-rt.ts</a></p>
<ol start="7">
<li>influxdb 数据导入 with Postman</li>
</ol>
<p>ref:</p>
<ul>
<li>
<p><a href="/">How to set up Postman to connect tencent dev poc environment.md</a></p>
</li>
<li>
<p><a href="http://localhost:8080/api-docs/client#/Timeseries/post_timeseries">post_timeseries</a></p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/node-fetch">node-fetch</a></p>
</li>
</ul>
<ol start="8">
<li>result images</li>
</ol>
<p><img alt="picture 3" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management%20depoly%20tencent%20poc_2023_05_17_15_31_3.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-24acc9c1174c2cb765606755caded7b0">3.4.9 - influxdb emission management</h1>
    
	<h1 id="objective---run-emissions-management">objective - run emissions management</h1>
<ol>
<li>import workflow</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\h</span>ello-workflows-emission-management.json  
</span></span></code></pre></div><p>then change source to <code>&quot;source&quot;: &quot;cn:zilong:rt&quot;</code></p>
<p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/hello-workflows-emission-management.json">hello-workflows-emission-management.json</a></p>
<ol start="2">
<li>import template</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\h</span>ello-templates-nz-emission-management.json  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/hello-templates-nz-emission-management.json">hello-templates-nz-emission-management.json</a></p>
<ol start="3">
<li>Register the sensors</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\t</span>est-rta-assets.json
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/test-rta-assets.json">test-rta-assets.json</a></p>
<ol start="4">
<li>Use task <code>pushDummyRealtimeValues</code> to generate dummy data</li>
</ol>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import -s cn:zilong -t rt -e <span style="color:#204a87">local</span>  
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-rt.ts">import-zilong-rt.ts</a></p>
<ol start="5">
<li>result images</li>
</ol>
<p><img alt="emission&rsquo;s kpi" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management_2023_05_11_17_27_3.png"></p>
<p><img alt="date range" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management_2023_05_11_17_28_1.png"></p>
<p><img alt="data view" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management_2023_05_11_17_30_0.png"></p>
<p><img alt="gas export data" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management_2023_05_11_17_30_3.png"></p>
<p><img alt="daily reporting" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management_2023_05_11_17_31_3.png"></p>
<p><img alt="influxDB Studio" src="/docs/Product/Kognitwin/Kognitwin-onboardinginfluxdb%20emission%20management_2023_05_11_17_41_4.png"></p>
<ol start="6">
<li>notes:</li>
</ol>
<p>6.1 最基础的版本，点击右侧指标，左侧chart展示的逻辑
通过 redis 的 pub sub， <code>&quot;message&quot;: &quot;SetWorkflowParameter&quot;</code>, 通过trigger loadScene方法实现的</p>
<p>6.2 pipeline的理解
daily reporting 的pipeline可以比较清楚的看到 对table数据的一个处理过程</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-439b695878e5a3c4d11470faccac60e9">3.4.10 - pnid import from scratch</h1>
    
	<h1 id="目标1-pdf导入mongodb">目标1 pdf导入mongodb</h1>
<ol>
<li>下载pdf文件。Keep only <code>1301-PWells_1-4.pdf</code> and <code>1301-PWells_5-8.pdf</code> under <code>C:\Cogs\KDI\cn\zilong\pnid</code>.</li>
</ol>
<ul>
<li>(1301-PWells_1-4.pdf)[https://dbinsp.sharepoint.com/:b:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/importPnid/1301-PWells_1-4.pdf?csf=1&amp;web=1&amp;e=4lCkBX]</li>
<li>(1301-PWells_5-8.pdf)[https://dbinsp.sharepoint.com/:b:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/KTW%20onboarding/importPnid/1301-PWells_5-8.pdf?csf=1&amp;web=1&amp;e=HzDfha]</li>
</ul>
<ol start="2">
<li>运行ktw add source 命令</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw add <span style="color:#204a87">source</span> cn:zilong:pnid  
</span></span></code></pre></div><ol start="3">
<li>
<p>创建正则表达式标注pdf文件
keep <code>demoFinder.json</code> under <code>C:\Cogs\KDI\cn\zilong\configs</code>
<a href="https://dbinsp.sharepoint.com/sites/KDIASKDIChina-SolutionandDev/_layouts/15/download.aspx?UniqueId=3e8a28c1fae542abbf493361993fa88e&e=zU4YIM">demoFinder.json</a></p>
</li>
<li>
<p>修改import-demo-pnid.ts， 参数inputDir, outputDir, finderFileDir, analyzerConfig
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-pnid.ts">import-demo-pnid.ts</a></p>
</li>
<li>
<p>在.env配置BINARY_SEARCH_PATHS（本地环境依赖）
参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/.env">.env</a></p>
</li>
<li>
<p>pdf文件导入mongdb, 运行ktw import 命令</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s cn:zilong -t pnid -e <span style="color:#204a87">local</span>  
</span></span></code></pre></div><ol start="7">
<li>效果图</li>
</ol>
<p><img alt="pnid import to mongdb" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_08_57_0.png"></p>
<p><img alt="KTW admin files" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_08_58_3.png"></p>
<h1 id="目标2---pdf在页面显示">目标2 - pdf在页面显示</h1>
<ol>
<li>
<p>创建workflows and templates<br>
1.1 参考 <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/demo-pnid-workflows-test.json">demo-pnid-workflows-test.json</a><br>
1.2 参考 <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/demo-pnid-no-documentviewer.json">demo-pnid-no-documentviewer.json</a></p>
</li>
<li>
<p>执行导入</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\d</span>emo-pnid-workflows-test.json -e <span style="color:#204a87">local</span>
</span></span><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\d</span>emo-pnid-no-documentviewer.json -e <span style="color:#204a87">local</span>
</span></span></code></pre></div><ol start="3">
<li>
<p>查看网页<br>
访问<a href="http://localhost:4200/no:document?document:id=1301-PWells_1-4">localhost:4200</a></p>
</li>
<li>
<p>效果图
<img alt="ktw admin workflows no:document" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_09_57_0.png"></p>
</li>
</ol>
<p><img alt="ktw admin template no:documentviewer" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_09_58_3.png"></p>
<p><img alt="pdf在页面显示" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_09_59_0.png"></p>
<p><img alt="在pdf上显示LinkType tag标记" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_11_08_3.png"></p>
<p><img alt="在pdf上显示LinkType tag标记" src="/docs/Product/Kognitwin/Kognitwin-onboardingpnid%20import%20from%20scratch_2023_04_27_11_08_1.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-06f844956fb47e609af610cee866eb80">3.4.11 - 关于Week1 </h1>
    
	<h1 id="目标">目标</h1>
<ul>
<li>
<p>了解什么是Kognitwin (KTW)</p>
</li>
<li>
<p><a href="/docs/product/kognitwin/kognitwin-onboarding/%E5%85%B3%E4%BA%8Eweek1/#目标---本地电脑跑起来KTW-具体实现步骤">本地电脑跑起来KTW</a></p>
</li>
</ul>
<h4 id="说明">说明</h4>
<ul>
<li>里面提到的Asset Model, Task framework 等，目前大致了解就行，看完PTT和视频，能理解多少就记住多少，后期会有更深的了解。</li>
</ul>
<h4 id="关于-video-digital-twn-intro-and-architechture">关于 Video :Digital Twn intro and Architechture</h4>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding2d18d81a-8b96-4cad-bfef-64f5a1077bbf.png"></p>
<p>上面提到的Twin.Shell, Twin.Chevron 是客户Shell, Chevron的部署，我们再腾讯云上也有一个PoC部署, 源码在<a href="https://kdic.coding.net/p/tencentpoc/d/Twin.Tencent/git">这</a>。</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding9058fbcb-b1e9-479f-84fb-3b241707d257.png"></p>
<p>上面列举的部署环境是KDI的，KDIC 会拿到最后的KTW 源代码的image</p>
<h2 id="安装npm遇到的问题">安装npm遇到的问题</h2>
<ol>
<li>如果在 Twin&gt; npm i 遇到如下报错，如log所示 缺少一个c++ 编译器把lib源码编译下</li>
</ol>
<p><img alt="MicrosoftTeams-image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding79f1712e-3a1c-41ee-b328-d1320fdfea51.png"></p>
<p>两种方法。第一种：re-run node.js setup and check this box。 （亲测有效）</p>
<p><img alt="MicrosoftTeams-image2.png" src="/docs/Product/Kognitwin/Kognitwin-onboardinge9f9af80-d262-4ec5-9da1-506baac8d49b.png"></p>
<p>第二种: <a href="https://github.com/nodejs/node-gyp">https://github.com/nodejs/node-gyp</a> 手动安装也可以，但是可能会稍微麻烦一些</p>
<h1 id="目标---本地电脑跑起来ktw-具体实现步骤">目标 - 本地电脑跑起来KTW 具体实现步骤</h1>
<ol>
<li>
<p>Tool and compilers​<br>
<a href="https://git-scm.com/downloads">Git</a><br>
<a href="https://nodejs.org/en/">Node.js (LTS version 16) </a> - 注意：需要安装c++ 编译器，参考<a href="/docs/product/kognitwin/kognitwin-onboarding/%E5%85%B3%E4%BA%8Eweek1/##-安装npm遇到的问题">安装npm遇到的问题</a><br>
<a href="https://www.docker.com/products/docker-desktop">Docker</a><br>
<a href="https://code.visualstudio.com/">Visual Studio Code</a><br>
<a href="https://dbinsp.sharepoint.com/:p:/s/KDIASDigitalTwinProductDevelopment/Ed6dJS-WZkVEuF8qKHdgjaEBHFi04qN8NBEu1gQm4yqQMA?e=jQPn7C">Visual Studio Code Extensions​</a><br>
<a href="https://cli.angular.io/">Angular CLI</a> or <code>npm install -g @angular/cli​</code></p>
</li>
<li>
<p>Optional tools<br>
<a href="https://www.sourcetreeapp.com/">Sourcetree</a><br>
<a href="https://robomongo.org/">Robo 3T</a></p>
</li>
<li>
<p>Cloning the repository<br>
3.1 Open your favorite CLI/terminal (cmd, PowerShell, VisualStudio Code Terminal)​<br>
3.2 Create root folder for your source code (e.g. C:\repos)​<br>
3.3 Clone the repo and check out the main development branch:<br>
<code>git clone git@e.coding.net:kdic/kdi-twin/Twin.git</code></p>
</li>
<li>
<p>Build the Twin
4.1 This will install dependencies for commonly-used workspaces and build library packages/workspaces.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>&gt; <span style="color:#204a87">cd</span> to/the/root/folder/of/Twin
</span></span><span style="display:flex;"><span>Twin&gt; npm run getting-started
</span></span></code></pre></div><p>4.2 Alternatively, if you prefer a full workspace setup, this 2 command will install and build all workspaces.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>Twin&gt; npm i
</span></span><span style="display:flex;"><span>Twin&gt; npm run build
</span></span></code></pre></div><ol start="5">
<li>Installing and running the databases</li>
</ol>
<ul>
<li>MongoDB:​</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker pull mongo​​:6.0
</span></span><span style="display:flex;"><span>docker run --name twin-mongodb --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -p 27017:27017 -d mongo:6.0
</span></span></code></pre></div><ul>
<li>Redis:​</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker pull redis​​:7.0
</span></span><span style="display:flex;"><span>nerdctl run --name redis --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -d -p 6379:6379 redis​:7.0
</span></span><span style="display:flex;"><span>docker run --name redis --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -d -p 6379:6379 redis​:7.0
</span></span></code></pre></div><ol start="6">
<li>Running the Twin services<br>
6.1 Backend server web API</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> server
</span></span><span style="display:flex;"><span>npm run serve
</span></span></code></pre></div><p>Go to http://localhost:8080 to verify the service is running</p>
<ul>
<li><a href="http://localhost:8080/api-docs/client">Client</a></li>
<li><a href="http://localhost:8080/api-docs/admin">Admin</a></li>
</ul>
<p>6.2 Frontend web client</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> client
</span></span><span style="display:flex;"><span>npm run start-twin
</span></span></code></pre></div><p>Go to http://localhost:4200 to verify the client is running.</p>
<p>6.3 Frontend admin UI (optional)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> client
</span></span><span style="display:flex;"><span>npm run start-admin
</span></span></code></pre></div><p>The admin page will be hosted at http://localhost:4201</p>
<p>6.4 Import service (optional)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> import
</span></span><span style="display:flex;"><span>npm run serve
</span></span></code></pre></div><p>6.5 Task service</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> taskservice
</span></span><span style="display:flex;"><span>npm run serve
</span></span></code></pre></div><p><code>curl localhost:9311/live</code> to verify that the service is running. If you want your twinservice instance to use this service, see server/.env:TWIN_USE_TASK_SERVICE</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-619de057a11d795fc775647745575bb3">3.4.12 - 关于Week2</h1>
    
	<h2 id="1-follow-only-step-4-and-5-in-httpsinternaldocskognitwincomdocsdevelopmentgetting_startedstep-by-step_guideshellolocal-kuberneteshttpsinternaldocskognitwincomdocsdevelopmentgetting_startedstep-by-step_guideshellolocal-kubernetes-and-follow-below-advices-when-facing-errors">1 Follow **ONLY **Step 4 and 5 in <a href="https://internal.docs.kognitwin.com/docs/development/getting_started/step-by-step_guides/hello.local-kubernetes/">https://internal.docs.kognitwin.com/docs/development/getting_started/step-by-step_guides/hello.local-kubernetes/</a> and follow below advices when facing errors:</h2>
<h3 id="安装ktw-cli遇到的问题">安装ktw cli遇到的问题:</h3>
<ol>
<li>如果在全局安装 ktw cli (<code>npm i -g @kognitwin/cli</code>)的时候没有权限(即使已经在本地的.npmrc文件配置了权限）.如下图所示</li>
</ol>
<p><img alt="MicrosoftTeams-image8.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding77abd84b-f42a-4857-a31d-05a4c9674a62.png"></p>
<p><img alt="Screenshot2023-03-23100218.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding6525f03a-17f5-495e-a47f-a8a722d0a110.png"></p>
<p>可以尝试local build，参考文档：<a href="https://kdic.coding.net/p/kdi-twin/d/Twin/git/tree/development/cli">https://kdic.coding.net/p/kdi-twin/d/Twin/git/tree/development/cli</a></p>
<p>Twin&gt; <code>npm run cli</code></p>
<p>成功后 Twin&gt; <code>ktw --version</code> 可以看到</p>
<p><img alt="MicrosoftTeams-image7.png" src="/docs/Product/Kognitwin/Kognitwin-onboardinga1fb6cc4-987c-4d1d-9932-c28ec4fed3ce.png"></p>
<h2 id="2-import-sample-3d-datahuldra-关于onboarding-plan-里面的">2. Import sample 3d data(Huldra) [关于onboarding plan 里面的]</h2>
<p><a href="https://internal.docs.kognitwin.com/docs/development/getting_started/setting_up_the_twin/huldra-import/">https://internal.docs.kognitwin.com/docs/development/getting_started/setting_up_the_twin/huldra-import/</a></p>
<ul>
<li><a href="/docs/product/kognitwin/kognitwin-onboarding/huldra-import-import-a-3d-model-from-scratch/">参考这个教程</a></li>
<li>在跑 Twin.KDI&gt; <code>npm i</code> 如果遇到npm ERR! code E401类似的错误:</li>
</ul>
<p><img alt="MicrosoftTeams-image15.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding8e566374-3baa-416b-97f0-4acca7ff8e47.png"></p>
<p>可以尝试:
First, delete the .npmrc file in your Users folder. This folder:
C:\Users[your user name]</p>
<p>然后复制黏贴Twin/.npmrc到Twin.KDI/.npmrc (替换到已有的，replace)</p>
<p>Then run this command in your project folder that has an .npmrc file in it:</p>
<p>Twin.KDI&gt; <code>npx vsts-npm-auth -config .npmrc</code></p>
<p><img alt="MicrosoftTeams-image14.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding745a534a-b28b-455a-becf-c798ec16b8df.png"></p>
<p>再次npm i，如果遇到E403， 这是由于没有权限。打开Twin.KDI/package.json，删除依赖的包-@kognitwin，再次npm i, 应该就可以了， 不影响导入流程</p>
<p><img alt="MicrosoftTeams-image17.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding87ebd114-a60f-4562-ab87-00b98097d6e6.png"></p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding1939ddad-25f9-494b-b8b5-ea60ad50055a.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0823f0f68ea4e493d0992fe1ac4329b2">3.4.13 - 配置timeseries </h1>
    
	<h1 id="install-influx">Install Influx</h1>
<ol>
<li>use v1.8, not v2, so far KT tutorial does not support it.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#000">docker</span> <span style="color:#000">pull</span> <span style="color:#000">influxdb</span>:<span style="color:#204a87;font-weight:bold">1.8</span>
</span></span><span style="display:flex;"><span><span style="color:#000">docker</span> <span style="color:#000">run</span> <span style="color:#ce5c00;font-weight:bold">--</span><span style="color:#000">name</span> <span style="color:#000">influx</span> <span style="color:#ce5c00;font-weight:bold">--</span><span style="color:#000">restart</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">always</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">p</span> <span style="color:#000">8086</span>:<span style="color:#204a87;font-weight:bold">8086</span> <span style="color:#000">influxdb</span>:<span style="color:#204a87;font-weight:bold">1.8</span>
</span></span></code></pre></div><ol start="2">
<li>Run task service</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span> <span style="color:#a40000">/c/repos/Twin: npm run serve -w taskservice</span>
</span></span></code></pre></div><p>3 Use task <code>pushDummyRealtimeValues</code> to generate dummy data (generate data for 2 sensors )</p>
<p>eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">ImportContext</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">from</span> <span style="color:#4e9a06">&#39;@kognitwin/cli&#39;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">async</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">importSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span>: <span style="color:#204a87;font-weight:bold">ImportContext</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importJson</span><span style="color:#000;font-weight:bold">([</span><span style="color:#4e9a06">&#39;test-rt.json&#39;</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;rt&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span>: <span style="color:#204a87;font-weight:bold">ImportContext</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importPipeline</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;rt&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;cn:test:import:rt&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;Cn Test Rt Import Pipeline&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">tasks</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;push_dummy_realtime_values_emissions&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;task&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;pushDummyRealtimeValues&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;configuration&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:test:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;isTaskRunningDuration&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;seconds&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;intervalinMS&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">30000</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;forLast&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;minutes&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;tagList&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;tag&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;range&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;min&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;max&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">11</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;tag&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM200-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;range&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;min&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;max&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">12</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;fromDate&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;toDate&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Could use InfluxDB Studio(I have uploaded to <a href="https://dbinsp.sharepoint.com/:u:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/Softwares/InfluxDBStudio-0.2.0.zip?csf=1&web=1&e=NjUuSo">Teams</a>, Just unzip and run) to view the data:</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboarding124ed8ee-c89f-4bab-a7fb-4e4bbba9b382.png"></p>
<p>4 Register the 2 sensors:</p>
<p>eg: test-rta-assets.json</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;assets&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:test:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Realtime&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;data&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;derived&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:test:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM200-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Realtime&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;data&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;derived&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>5 Import workflow. ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/master/cn/test/cn-test-workflows-rt.json">https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/master/cn/test/cn-test-workflows-rt.json</a></p>
<p>6 Open http://localhost:4200/cn:test:realTime:test:new. result should be like:</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/Kognitwin-onboardingd1badccf-6344-41a1-8e98-8cdb5530cbd2.png"></p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5e04e82d59dd64c709218e466763306d">3.5 - How to backup and restore mongodb</h1>
    
	<h2 id="this-guide-will-show-you-how-to-backup-all-mongodb-collections-from-a-container-and-restore-them-to-another-container">This guide will show you how to backup all mongodb collections from a container and restore them to another container</h2>
<h3 id="note">Note:</h3>
<ul>
<li>This guide is using <code>Rancher Desktop</code>, for docker, it is similar, one only need to change <code>nerdctl</code> to <code>docker</code> in below commands:</li>
</ul>
<hr>
<h3 id="guide">Guide:</h3>
<ul>
<li>
<p>Backup</p>
<ul>
<li>Get into the mongo container you want to backup:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># list the mongo container id</span>
</span></span><span style="display:flex;"><span>nerdctl container ls
</span></span></code></pre></div><p><img alt="picture 0" src="/docsHow%20to%20backup%20and%20restore%20mongodb_2023_09_12_15_01_0.png"></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>nerdctl <span style="color:#204a87">exec</span> -it 86c31157db5a bash
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># run below cmd inside the container</span>
</span></span><span style="display:flex;"><span>mongodump  --gzip --archive &gt; dump_<span style="color:#4e9a06">`</span>date <span style="color:#4e9a06">&#34;+%Y-%m-%d&#34;</span><span style="color:#4e9a06">`</span>.gz
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># exit the container</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># copy the dump to current directory &#34;C:\Users\LongCui\Downloads\mongo-backup&#34;</span>
</span></span><span style="display:flex;"><span>nerdctl cp 86c31157db5a:/dump_2023-09-11.gz .
</span></span></code></pre></div></li>
<li>
<p>Restore</p>
<ul>
<li>attach the backup file to the container. for example:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker run --name twin-mongodb-import --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -p 27017:27017 -v C:<span style="color:#4e9a06">\U</span>sers<span style="color:#4e9a06">\L</span>ongCui<span style="color:#4e9a06">\D</span>ownloads<span style="color:#4e9a06">\m</span>ongo-backup:doww  -d mongo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> doww
</span></span><span style="display:flex;"><span>mongorestore --gzip --archive<span style="color:#ce5c00;font-weight:bold">=</span>dump_2023-09-11.gz
</span></span></code></pre></div><p><img alt="picture 1" src="/docsHow%20to%20backup%20and%20restore%20mongodb_2023_09_12_15_28_3.png"></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-da18efafe95dd565746a4a2a54eaea51">3.6 - tips</h1>
    <div class="lead">Already installed? Play us a song, Navidrome!</div>
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-49b8822dfaadecebbf288ba008e230d5">3.6.1 - How-to-solve-npm-i-e401</h1>
    
	<p>When we run <code>npm getting-started</code> or <code>npm i</code> under <code>Twin</code> or <code>ktw new workspace YOUR_WORKSPACE</code>, we most likely encounter the error 401: not having permission issue, this is due to no access to Azure devops.</p>
<h2 id="solution">Solution:</h2>
<ul>
<li>for example, if the package.json has below <code>dependencies</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;dependencies&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;@azure-tools/azcopy-node&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^2.5.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;@kognitwin/cli&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^1.0.473&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;@kognitwin/common&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^1.0.473&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;@kognitwin/import-task-configs&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^1.0.365&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;@kognitwin/sdk&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^1.0.473&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;@kognitwin/task-configs&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^1.0.411&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;lodash&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;^4.17.20&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">,</span> 
</span></span></code></pre></div><ul>
<li>Remove all @kognitwin/* dependencies since we do not have access.
<ul>
<li>
<p>in CMD, Run</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm link C:<span style="color:#4e9a06">\r</span>epos<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\c</span>ommon 
</span></span><span style="display:flex;"><span>npm link C:<span style="color:#4e9a06">\r</span>epos<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\s</span>dk 
</span></span><span style="display:flex;"><span>npm link C:<span style="color:#4e9a06">\r</span>epos<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\i</span>mport<span style="color:#4e9a06">\i</span>mport-task-configs 
</span></span><span style="display:flex;"><span>npm link C:<span style="color:#4e9a06">\r</span>epos<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\t</span>askservice<span style="color:#4e9a06">\t</span>ask-configs 
</span></span><span style="display:flex;"><span>npm link C:<span style="color:#4e9a06">\r</span>epos<span style="color:#4e9a06">\T</span>win<span style="color:#4e9a06">\c</span>li
</span></span></code></pre></div></li>
<li>
<p>Then, run <code>npm i</code>, now all listed dependencies should be installed.</p>
</li>
</ul>
</li>
</ul>
<h3 id="ref">ref:</h3>
<p>we use <code>npm link</code> here to link the dependencies to our local source code.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c2382f743f3d7590497793b51d3d461f">3.6.2 - HowtodebugNodeJs</h1>
    
	<p>在执行这行命令:<code>ktw import -s root</code> in /tutorial/hello or /Twin.KDI，如果遇到如下问题 (附nodejs调试方法)</p>
<p><img alt="MicrosoftTeams-image18.png" src="/docs/Product/Kognitwin/tipsf9aac35b-aa73-48e0-8cff-2e80e01dcd0f.png"></p>
<p>1）在/Twin/cli/下全局搜索&rsquo;result:&rsquo;,定位到是这里报错</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/tips112163ed-492b-4d1f-81d4-b5190cb1dbfc.png"></p>
<ol start="2">
<li>VS Code, Terminal - New Terminal, 选择Twin repo(要选择调试代码的repo，否则进不了断点)</li>
</ol>
<p><img alt="MicrosoftTeams-image19.png" src="/docs/Product/Kognitwin/tips01ccd991-6d64-427f-97ef-9a958baa5dc3.png"></p>
<p>3)javascript debug terminal，选择Twin.KDI or /tutorial/hello/ (选择其他的会报错 - [ERROR] Import command can&rsquo;t be run outside of a ktw workspace.)</p>
<p><img alt="MicrosoftTeams-image20.png" src="/docs/Product/Kognitwin/tips2aa897a0-6d63-4ac0-9dd7-43a4c75562ea.png"></p>
<p>4)标记断点</p>
<p>断点标记 vs debugger 两种方式都可以
VSCode 行号左侧的小红点就是断点标记，表示程序执行到这一行就会停下来</p>
<p><img alt="MicrosoftTeams-image21.png" src="/docs/Product/Kognitwin/tips628b3b8d-5df6-479e-94d7-8a309a462cb2.png"></p>
<p>5)执行ktw import -s root进入断点</p>
<p><img alt="MicrosoftTeams-image22.png" src="/docs/Product/Kognitwin/tips60a99e45-038f-4f52-937f-052a9f20f577.png"></p>
<ol start="6">
<li>问题出在context.client.apiUrl - &lsquo;<a href="https://hello.localdev.me/api/'">https://hello.localdev.me/api/'</a></li>
</ol>
<p><img alt="MicrosoftTeams-image23.png" src="/docs/Product/Kognitwin/tips6fcaca35-90e9-43f5-a1d8-ad3109b4947c.png"></p>
<p>7)发现/tutorial/hello/的ktw运行环境ktw.json，默认为https://hello.localdev.me/api/,但是本地并没有启动这个服务</p>
<p><img alt="image.png" src="/docs/Product/Kognitwin/tips07f4a175-00c5-4e63-b973-25435941f055.png"></p>
<p>8)通过ktw帮助命令行， ktw import -h， 可以通过-e指定运行环境</p>
<p>ktw import -s root -e local</p>
<p><img alt="MicrosoftTeams-image24.png" src="/docs/Product/Kognitwin/tipsa0275f4f-e8e6-456d-a3e0-67a376061f09.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dfdb9907489fe3081f807e4872a4bde5">3.6.3 - Howto查看MongoDB数据库内容</h1>
    
	<p><img alt="image.png" src="/docs/Product/Kognitwin/tips47a7236b-ecd0-4692-ad8d-af1b8712e29a.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c7a8010dca5aa6f5bb7f2ab8ed8864aa">3.6.4 - </h1>
    
	<p>开始分享吧</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d5e30396fab17ba34e033352dc98027b">3.7 - How to create node-opcua server image</h1>
    
	<p>How to create node-opcua server image</p>
<h1 id="background">Background</h1>
<p>在做实时计算模块时，需要用到 node-opcua 库做为数据源提供实时数据。在本地实现的时候，可以用 localhost 地址作为数据源的接入。但是当 Kognitwin 部署到 dev 环境时，就需要提供一个 node opcua server 的外网地址作为数据源接入。因此将一个 node.js 的应用装入到 docker 容器中， 然后部署到云环境就成为了一种可行的解决方式。</p>
<h1 id="how-to-use-it">How to use it</h1>
<ol>
<li>
<p>create Node.js web app</p>
<p>1.1 create package.json file, eg:</p>
<pre><code>```json
{
    &quot;name&quot;: &quot;docker_web_app&quot;,
    &quot;version&quot;: &quot;1.0.0&quot;,
    &quot;description&quot;: &quot;Node.js on Docker&quot;,
    &quot;author&quot;: &quot;First Last &lt;first.last@example.com&gt;&quot;,
    &quot;main&quot;: &quot;sample_server.js&quot;,
    &quot;scripts&quot;: {
        &quot;start&quot;: &quot;node sample_server.js&quot;
    },
    &quot;dependencies&quot;: {
        &quot;node-opcua&quot;: &quot;2.103.0&quot;
    }
}

```
</code></pre>
<p>1.2 npm install</p>
<pre><code>run `npm install`cmd. eg:  
```sh
npm install
```
</code></pre>
<p>1.3 create sample_server.js file</p>
<pre><code>ref: [sample_server.js](https://github.com/node-opcua/node-opcua/blob/master/documentation/sample_server.js)
</code></pre>
</li>
<li>
<p>create Dockerfile</p>
<p>2.1 create Dockerfile eg:</p>
<pre><code> ```sh
 FROM node:18

 # Create app directory
 WORKDIR /usr/src/app

 # Install app dependencies
 # A wildcard is used to ensure both package.json AND package-lock.json are copied
 # where available (npm@5+)
 COPY package*.json ./

 RUN npm install
 # If you are building your code for production
 # RUN npm ci --omit=dev

 # Bundle app source
 COPY . .

 EXPOSE 4334

 CMD [ &quot;node&quot;, &quot;sample_server.js&quot; ]
 ```

 tips: 你的应用程序绑定的端口为 4334，所以你可以使用 EXPOSE 命令使它与 docker 的镜像做
 映射。
</code></pre>
<p>2.2 create .dockerignore file, eg:</p>
<pre><code> ```sh
 node_modules
 npm-debug.log
 ```
</code></pre>
</li>
<li>
<p>构建镜像</p>
<p>3.1 进入到 Dockerfile 所在的那个目录中， run <code>docker build</code>cmd. eg:</p>
<pre><code> ```sh
 docker build . -t demo/node-opcua-server-new-app
 ```
</code></pre>
<p>3.2 check docker image list</p>
<pre><code> run `docker images`cmd
</code></pre>
<p><img alt="picture 0" src="/docsHow%20to%20create%20node-opcua%20server%20image_2023_07_25_17_50_1.png"></p>
</li>
<li>
<p>运行镜像</p>
<p>run <code>docker run</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker run -p 4334:4334 -d demo/node-opcua-server-new-app
</span></span></code></pre></div><p>tips: 开关符 -p 在容器中把一个公共端口导向到私有的端口。 第一个<code>4334</code>为你机器上的公共端口
<code>http://localhost:4334</code>, 第二个<code>4334</code>为之前构建的镜像 <code>EXPOSE</code> 暴露出来的端口。</p>
<p>在容器中 Docker 把第二个端口号 <code>4334</code> 映射到你机器上的 第一个端口号 <code>4334</code></p>
</li>
</ol>
<h1 id="reference">reference</h1>
<ul>
<li>
<p><a href="https://nodejs.org/zh-cn/docs/guides/nodejs-docker-webapp#%E6%8A%8A%E4%B8%80%E4%B8%AA-node.js-web-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%BB%99-docker-%E5%8C%96">把一个 Node.js web 应用程序给 Docker 化</a></p>
</li>
<li>
<p><a href="https://github.com/node-opcua/node-opcua">node-opcua</a></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5769c44e8012021889e80f7246cd34c7">3.8 - How to create user and roles</h1>
    
	<p>How to create user and roles</p>
<ol>
<li>
<p>create <code>&quot;id&quot;: &quot;poc_nyh_read_user&quot;,</code> roles</p>
<p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/hello-roles-read-nyh.json">hello-roles-read-nyh.json</a></p>
</li>
<li>
<p>创建账号的两种方式</p>
<p>2.1 方式一： 自己创建用户 （推荐）</p>
<pre><code>1. run `ktw add user` cmd. eg:

     ```sh
     ktw add user testuser1 --roles poc_nyh_read_user
     ```

     ```json
     {
     &quot;users&quot;: [
         {
         &quot;type&quot;: &quot;user&quot;,
         &quot;email&quot;: &quot;testuser1&quot;,
         &quot;name&quot;: &quot;firstName lastName&quot;,
         &quot;roles&quot;: [
             &quot;poc_nyh_read_user&quot;
         ],
         &quot;idp&quot;: &quot;keycloak&quot;,
         &quot;idpLink&quot;: &quot;kdi_azuread&quot;
         }
     ]
     }
     ```

2. run `ktw import` cmd. eg:  

     ```sh
     ktw import hello-users.json -e dev-tencent
     ```

     ref: [hello-users.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/hello-users.json)

3. SRE 设置初始化密码发给用户， 用户登录后需要更改密码来激活账户
</code></pre>
<p><img alt="picture 0" src="/docsHow%20to%20create%20user%20and%20roles_2023_08_25_11_06_2.png"></p>
<p>2.2 方式二： SRE 创建用户</p>
<pre><code>  1. SRE 创建账号， 必填项: username，选填项: email, 建议 email 也填上， 这样可以方便用户通过用户名 或者 电子邮箱地址登录 eg: username: testuser1, email: testuser1@kdi.com   

  2. 同 方式一 的第一步

     tips: `users` 里的 email - `&quot;email&quot;: &quot;testuser1&quot;,` 需要于 SRE 创建的 username 保持一致

  3. 后面 同 方式一 的 2，3 项
</code></pre>
</li>
</ol>
<h1 id="results">results</h1>
<p><img alt="picture 2" src="/docsHow%20to%20add%20testuser_2023_08_14_10_03_4.png"></p>
<p><img alt="picture 1" src="/docsHow%20to%20add%20testuser_2023_08_14_10_02_0.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-7e2cce1514d77d89e3ae0f9c7b47bf30">3.9 - How to deploy to another environment</h1>
    
	<p>For example, if target is</p>
<ul>
<li>kognitwin:<code>https://poc.kognitwin.cn</code></li>
<li>keycloak:  <code>https://login.poc.kognitwin.cn/</code></li>
</ul>
<p>run <code>ktw add environment</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw add environment poc-a https://poc.kognitwin.cn/api --idp<span style="color:#ce5c00;font-weight:bold">=</span>keycloak --tenantId dev-poc --clientId twin-devicelogin --authServerUrl https://login.poc.kognitwin.cn/ 
</span></span></code></pre></div><p>then for deploying to the target, run normal <code>ktw import</code> cmd plus <code>-e poc-a</code> at the end.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ae221b96ece5a1a374f214b5983b5efe">3.10 - How to run Kognitwin using Rancher Desktop</h1>
    
	<p>How to run Kognitwin using Rancher Desktop</p>
<ol>
<li>download rancher desktop to your PC</li>
</ol>
<p><a href="https://rancherdesktop.io/">official website</a></p>
<ol start="2">
<li>Start Mongo container, eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>nerdctl pull mongo​​:6.0
</span></span><span style="display:flex;"><span>nerdctl run --name twin-mongodb --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -p 27017:27017 -d mongo:6.0
</span></span></code></pre></div><ol start="3">
<li>Start Redis container, eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>nerdctl pull redis​:7.0
</span></span><span style="display:flex;"><span>nerdctl run --name twin-redis --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -d -p 6379:6379 redis​:7.0
</span></span></code></pre></div><ol start="4">
<li>Start influx container, eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>nerdctl pull influxdb:1.8
</span></span><span style="display:flex;"><span>nerdctl run --name influx --restart<span style="color:#ce5c00;font-weight:bold">=</span>always -p 8086:8086 influxdb:1.8
</span></span></code></pre></div><ol start="5">
<li>Note: if you notice an error with server failing to connect with MongoDb at localhost:27017. You may need to change your ipv6 precedence and label</li>
</ol>
<p>ref: <a href="https://internal.docs.kognitwin.com/development/getting_started/quick/twin-setup/#run-server">Run Server</a></p>
<h1 id="reference">reference</h1>
<ul>
<li><a href="https://internal.docs.kognitwin.com/development/getting_started/quick/twin-setup/#run-applications">Twin Setup - Start Mongo container, Start Redis container</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db930a25fb0a3e933662e91c73a92585">3.11 - How to send messges</h1>
    
	<h3 id="reload-search-config-msg">Reload search config msg:</h3>
<ul>
<li>Requisite
<ul>
<li>the search service need to be running</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;subject&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;admin:search&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#39;com.kognitwin.search.reloadConfig.v1&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><br/>
<p><img alt="picture 1" src="/docsHow%20to%20send%20messges_2023_05_17_17_26_0.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-189dd23aaee9af6f7cc53989c4a47fb8">3.12 - How to set up search feature</h1>
    
	<h1 id="how-to-set-up-search-feature">How to set up search feature</h1>
<ol>
<li>Add a <code>search</code> template to <code>project.templates</code>.
eg(the <code>source</code>, <code>id</code> &hellip; need to be updated</li>
</ol>
<ul>
<li>替换 source: teams:viz:hul:v3d 为项目定义的source</li>
<li>Index 的 key: teams:viz:hul:v3d是该index的识别id，建议根据模板修改<br>
):</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;search&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;indexes&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;cn:zilong:v3d&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;query&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:v3d&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;PIPE,VALV,EQUI,INST,PCOM,SUBE,FILT,SHU,ATTA,FLAN,NOZZ,MECH,STRU,ELEC,PSUP,HVAC,SAFE,TELE,ARCH&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;projection&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;flexDoc&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;field&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;type&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;store&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;options&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;boostFields&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;cn:zilong:edw:tag&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;query&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:edw&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Tag&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;projection&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;flexDoc&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;field&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;type&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;store&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;options&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;boostFields&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;cn:zilong:edw:doc&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;query&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:edw&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Document&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;projection&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;flexDoc&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;field&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;type&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;store&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;options&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;boostFields&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/hello-projects.json">hello-projects.json</a></p>
<ol start="2">
<li>
<p>Add a <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/global/templates/cn-search.json">generic template</a> for search configuration</p>
</li>
<li>
<p>Add a <code>search</code> template to your v3d <code>workflow</code> to use the generic template above. eg:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;search&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;operation&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;compose@0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;templates&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:search&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;parameters&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;scope&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;siteScope&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hello&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>参考<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/hul/hul-workflows-main.json">zilong-workflows-main.json</a></p>
<ol start="4">
<li>restart the twin server. Please notice the log: eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.923Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:v3d&#39;</span> with <span style="color:#0000cf;font-weight:bold">40154</span> entries in 3s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.924Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 63.98MB, total 273.05MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.924Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Creating search index <span style="color:#4e9a06">&#39;cn:zilong:edw:tag&#39;</span> ...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.980Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:v3d&#39;</span> with <span style="color:#0000cf;font-weight:bold">40154</span> entries in 3s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.981Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 32.75MB, total 274.95MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.981Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Creating search index <span style="color:#4e9a06">&#39;cn:zilong:edw:tag&#39;</span> ...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.983Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:edw:tag&#39;</span> with <span style="color:#0000cf;font-weight:bold">1</span> entries in 0s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.984Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 0.01MB, total 273.07MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.984Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Creating search index <span style="color:#4e9a06">&#39;cn:zilong:edw:doc&#39;</span> ...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:06.999Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:v3d&#39;</span> with <span style="color:#0000cf;font-weight:bold">40154</span> entries in 3s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.000Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 63.80MB, total 274.49MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.000Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Creating search index <span style="color:#4e9a06">&#39;cn:zilong:edw:tag&#39;</span> ...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.033Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:edw:doc&#39;</span> with <span style="color:#0000cf;font-weight:bold">1</span> entries in 0s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.033Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:edw:tag&#39;</span> with <span style="color:#0000cf;font-weight:bold">1</span> entries in 0s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.034Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 0.01MB, total 273.07MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.034Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 0.02MB, total 274.96MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.034Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Creating search index <span style="color:#4e9a06">&#39;cn:zilong:edw:doc&#39;</span> ...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.043Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:edw:tag&#39;</span> with <span style="color:#0000cf;font-weight:bold">1</span> entries in 0s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.043Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 0.01MB, total 274.50MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.043Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Creating search index <span style="color:#4e9a06">&#39;cn:zilong:edw:doc&#39;</span> ...
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.083Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:edw:doc&#39;</span> with <span style="color:#0000cf;font-weight:bold">1</span> entries in 0s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.083Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 0.00MB, total 274.97MB
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.093Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Created search index <span style="color:#4e9a06">&#39;cn:zilong:edw:doc&#39;</span> with <span style="color:#0000cf;font-weight:bold">1</span> entries in 0s
</span></span><span style="display:flex;"><span>2023-04-28T01:40:07.093Z <span style="color:#ce5c00;font-weight:bold">[</span>log<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>info<span style="color:#ce5c00;font-weight:bold">]</span>: flexsearch: Search RSS delta 0.00MB, total 274.51MB
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ol start="5">
<li>最终效果图<br>
<img alt="最终效果图" src="/docsHow%20to%20set%20up%20search%20feature_2023_04_25_13_59_1.png"></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bfa904d913affc553bce389e98983813">3.13 - How to use OpenDialog in realtime calculator</h1>
    
	<p>How to use OpenDialog in realtime calculator</p>
<ol>
<li>
<p>config <code>triggers.contextmenu</code> in rta-rcd-components.json. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;contextmenu&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ShowContextMenu&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;event&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;syncAsset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;asset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$clicked&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;template&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>             <span style="color:#204a87;font-weight:bold">&#34;items&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;查看历史数据&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;OpenDialog&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#204a87;font-weight:bold">&#34;icon&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;info_outline&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#204a87;font-weight:bold">&#34;template&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:rcd:dialog:chart:demo&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#204a87;font-weight:bold">&#34;asset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                                 <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$clicked.id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                                 <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$clicked.source&#34;</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                         <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>             <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/templates/components/rta-rcd-components.json">rta-rcd-components.json</a></p>
</li>
<li>
<p>config template <code>&quot;id&quot;: &quot;teams:rta:rcd:dialog:chart:demo&quot;</code> in rta-rcd-dialogs.json. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:rcd:dialog:chart:demo&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;asset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;defaults&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;variables&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;dialog&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;component&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DynamicLayoutDialogComponent&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;panelClass&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;w-1/2&#34;</span><span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;layout&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DynamicLayoutComponent&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;components&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;splitLayout&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;displayName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Chart View&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;displayIcon&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;show_chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;isVisible&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;cssClasses&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ChartGridViewComponent@2&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;resizable&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;axis&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;x&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;position&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;end&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;rowHeight&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;cols&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;rtAssetId&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;rtAssetSource&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;defaults&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;rowHeight&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;notfit&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;cols&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;rtAssetId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;rtAssetSource&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;layoutConfig&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Charts View&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;icon&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;show_chart&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;inputs&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;gridConfig&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cols&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$parameters.cols&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;rowHeight&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$parameters.rowHeight&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;rowHeightsPerCol&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;5:3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;3:4&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;3:5&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;3:5&#34;</span><span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;colSwitch&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cardConfig&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#204a87;font-weight:bold">&#34;options&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;lineSelection&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#204a87;font-weight:bold">&#34;enabled&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#204a87;font-weight:bold">&#34;legend&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;defaultLineWidth&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;selected&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#204a87;font-weight:bold">&#34;LineWidth&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#204a87;font-weight:bold">&#34;StrokeStyle&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;rgba(0,0,0,0.35)&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#204a87;font-weight:bold">&#34;yAxis&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;defaultBorderWidth&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;selectedBorderWidth&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;cardTools&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#204a87;font-weight:bold">&#34;dateRange&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;selected&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;30_day&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1_day&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1 day&#34;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;7_day&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;7 days&#34;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;30_day&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;30 days&#34;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;60_day&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;60 days&#34;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;label&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Data range: &#34;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;scene&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;layers&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#204a87;font-weight:bold">&#34;rtAsset&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;assets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.id&#34;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;defaultQueryTemplate&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;query&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#204a87;font-weight:bold">&#34;limit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100000</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#204a87;font-weight:bold">&#34;units&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;from&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$(attr($asset.attributes, unit))&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">&#34;to&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$(attr($asset.attributes, displayUnit))&#34;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/templates/dialogs/rta-rcd-dialogs.json">rta-rcd-dialogs.json</a></p>
</li>
<li>
<p>post some historical data point in influxdb, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;points&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-01T00:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-02T01:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">99</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-03T02:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-04T03:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">85</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-05T04:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-06T05:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">88</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-07T06:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-08T07:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">92</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-09T08:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-10T09:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">90</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-11T10:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-12T11:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">98</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-07-13T01:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">6</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>results</p>
<p><img alt="picture 0" src="/docsHow%20to%20use%20OpenDialog%20in%20realtime%20calculator_2023_07_13_14_32_3.png"></p>
</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b4d5a2ef5f85b831ad6ab5767fb66df0">3.14 - KTW deploys Lingque Cloud</h1>
    
	<h1 id="objective---depoly-in-alauda-standalong">objective - depoly in alauda standalong</h1>
<h2 id="feature-list">feature list</h2>
<ul>
<li>v3d(huldra import)</li>
<li>search feature</li>
<li>edw import</li>
<li>pnid import</li>
<li>edw links to pnid(Show in split view, open in new tab)</li>
<li>influxdb basic version</li>
</ul>
<ol>
<li>create environment
run <code>ktw add environment</code>cmd. eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw add environment poc-alauda-standalong https://poc.kognitwin.cn/api --idp<span style="color:#ce5c00;font-weight:bold">=</span>keycloak --tenantId dev-poc --clientId twin-devicelogin --authServerUrl https://login.poc.kognitwin.cn/ 
</span></span></code></pre></div><ol start="2">
<li>import root &amp; admin &amp; global &amp; search feature &amp; context menu
run <code>ktw import</code>cmd. eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import -s root admin global -e poc-alauda-standalong
</span></span><span style="display:flex;"><span>ktw import global<span style="color:#4e9a06">\t</span>emplates<span style="color:#4e9a06">\c</span>n-search.json -e poc-alauda-standalong
</span></span><span style="display:flex;"><span>ktw import global<span style="color:#4e9a06">\t</span>emplates<span style="color:#4e9a06">\c</span>n-context-menu.json -e poc-alauda-standalong
</span></span></code></pre></div><ol start="3">
<li>import v3d, edw, pnid, rt
run <code>ktw import</code>cmd. eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import -s cn:zilong -e poc-alauda-standalong
</span></span></code></pre></div><ol start="4">
<li>ktw upload textures to your Twin server files<br>
4.1 download <code>twin-view</code> files<br>
<a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/files/twin-view">twin-view</a></li>
</ol>
<p>4.2 run <code>ktw upload</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw upload files -e poc-alauda-standalong
</span></span></code></pre></div><ol start="5">
<li>setup timeseries influx basic version</li>
</ol>
<p>5.1 change server influx host to <code>influxdb.ktw</code>  , then import sources<br>
run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\z</span>ilong-rt.json -e poc-alauda-standalong
</span></span></code></pre></div><p>5.2 Register the sensors
run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\t</span>est-rta-assets.json -e poc-alauda-standalong    
</span></span></code></pre></div><p>5.3 import mock data with postman</p>
<p>eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;points&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  1:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  2:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">20</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  3:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">30</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  4:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">40</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  5:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">50</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  6:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">60</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  7:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">70</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  8:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">80</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;5/18/2023  9:20:02 AM&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">90</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/km/d/knowledge-management/git/tree/master/%E4%BA%A7%E5%93%81/Kognitwin/Kognitwin-onboarding/How%20to%20set%20up%20Postman%20to%20connect%20tencent%20dev%20poc%20environment.md">How to set up Postman to connect tencent dev poc environment.md</a></p>
<ol start="6">
<li>results images</li>
</ol>
<p><img alt="frontend admin ui" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_17_16_37_0.png"></p>
<p><img alt="huldra" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_17_16_42_1.png"></p>
<p><img alt="search feature" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_17_16_43_3.png"></p>
<p><img alt="edw links to pnid" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_17_16_47_3.png"></p>
<p><img alt="edw links to pnid Show in split view" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_17_16_48_2.png"></p>
<p><img alt="edw links to pnid open in new tab" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_17_16_50_3.png"></p>
<p><img alt="influxdb basic version" src="/docsKTW%E9%83%A8%E7%BD%B2%E7%81%B5%E9%9B%80%E4%BA%91%20standalong_2023_05_18_17_55_2.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9b81d83ff3edb23b65b45ba52baaec88">3.15 - README</h1>
    
	<p>这是一个给研发做知识管理的平台，请大家积极分享自己的经验，用的好的软件，值得读的书，建议要听的讲座等。</p>
<p>积极主动地参与到咱这个平台的贡献中！</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c6b74741a0ec7c8de12625b0b25659b6">3.16 - TerraForm</h1>
    
	<h1 id="how-to-manage-cloud-infrastructure-with-terraform">How to manage cloud infrastructure with TerraForm</h1>
<h2 id="what-is-terraform-">What is Terraform ?</h2>
<p>Terraform is an infrastructure as code (IaC) tool that allows you to build, change, and version infrastructure safely and efficiently. This includes both low-level components like compute instances, storage, and networking, as well as high-level components like DNS entries and SaaS features.</p>
<h2 id="background-of-terraform-in-the-poc">Background of Terraform in the PoC</h2>
<p>In this PoC we did not use Terraform to manage the IaC, but after we deployed the Kognitwin we plan to import the resource of Tencent cloud and try to provide the refer to other cloud platform.</p>
<h2 id="reference-documents">Reference documents</h2>
<p><a href="https://www.terraform.io/">Terraform website </a></p>
<p><a href="https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs">
Tencentcloud documents in Terraform </a></p>
<p><a href="https://cloud.tencent.com/developer/article/1473713">
Tencentcloud with Terraform guidance in Tecnent community</a></p>
<p>(Chinese document)</p>
<h2 id="steps-of-terraform-installation-and-configuration">Steps of Terraform installation and configuration</h2>
<h3 id="download-the-latest-version-of-terraform-">Download the latest version of Terraform :</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    // download terraform
    $ wget https://releases.hashicorp.com/terraform/1.2.8/terraform_1.2.8_linux_amd64.zip
</code></pre><p>Note : as suggested by Tencent cloud, it is better to install the Terraform on a CVM. And we found that the CVM in Beijing cannot connect terraform.io smoothly, from our PoC team&rsquo;s best practice, install the Terraform on the CVM in Hongkong region.</p>
<h3 id="create-a-new-folder-and-move-terrafrom-to-this-folder">Create a new folder and move Terrafrom to this folder.</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    // Move terraform
    $ mkdir downloads
    $ mv terraform downloads/
</code></pre><h3 id="add-terraform-path-in-the-configure-file-profile">Add Terraform path in the configure file .profile</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    $ vim ~/.profile
    // Add terraform PATH
    export PATH=&#34;$PATH:~/downloads&#34;
</code></pre><h3 id="reload-the-profile-file">Reload the .profile file</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    $ source ~/.profile
</code></pre><h3 id="check-the-terraform-version">Check the Terraform version</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    $ terraform -version
    Terraform v1.2.8
    on linux_amd64
</code></pre><h3 id="create-the-providertf">Create the provider.tf</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    terraform {
        required_providers {
            tencentcloud = {
            source = &#34;tencentcloudstack/tencentcloud&#34;
            version = &#34;1.77.4&#34;
            }
        }
    }

    provider &#34;tencentcloud&#34; {
        secret_id  = &#34;************************************&#34; # create API secret_id in Tencent cloud console
        secret_key = &#34;**********************************&#34;   # create API secret_key in Tencent cloud console
        region     = &#34;ap-guangzhou&#34;  # the region which the resouce was located, the region name can be #refered the link. https://intl.cloud.tencent.com/zh/document/product/236/8458

    }
</code></pre><h2 id="steps-of-import-the-tencent-cloud-resouce-into-terraformtfstat">Steps of import the Tencent cloud resouce into terraform.tfstat</h2>
<h3 id="create-an-empty-tf-file">Create an empty .tf file</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    #provider tencentcloud {} #if there is the tencentcloud define in provider.tf, no need this line.
    resource &#34;tencentcloud_instance&#34; &#34;test&#34; {}  # &#34;tencentcloud_instance&#34; is the resouce name in Tencent cloud
    # refer to https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs to get all the resource name which can be managed by Terraform in Tencent cloud. 
</code></pre><h3 id="terraform-init">terraform init</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">&#34;terraform init&#34;
</code></pre><h3 id="terraform-import">terraform import</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    &#34;terraform import tencentcloud_instance.test ins-eh8r833f&#34;
    # for example the ins-eh8r833f is the instance name which can be found in Tencent cloud console. 
    # some types of resouce cannot support the Terraform import command, refer to https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs
</code></pre><pre tabindex="0"><code class="language-null" data-lang="null">then the resouce infomation has been put into the Terraform.tfstate
</code></pre><h3 id="terraform-show">terraform show</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    &#34;terraform show&#34;
</code></pre><h3 id="copy-the-relevant-resouce-items-into-the-tencentcloudtf">copy the relevant resouce items into the tencentcloud.tf</h3>
<pre tabindex="0"><code class="language-null" data-lang="null">    &#34;terraform plan&#34; 
</code></pre><p>to check the resouce has be managed by Terrafrom.</p>
<p>Note: 弹性集群可以用来import，托管集群不可用来import</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-be9bcc55d8540fe680f7bfc8d50a8829">3.17 - how to setup timeseries </h1>
    
	<h1 id="install-influx">Install Influx</h1>
<ol>
<li>use v1.8, not v2, so far KT tutorial does not support it.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#000">docker</span> <span style="color:#000">pull</span> <span style="color:#000">influxdb</span>:<span style="color:#204a87;font-weight:bold">1.8</span>
</span></span><span style="display:flex;"><span><span style="color:#000">docker</span> <span style="color:#000">run</span> <span style="color:#ce5c00;font-weight:bold">--</span><span style="color:#000">name</span> <span style="color:#000">influx</span> <span style="color:#ce5c00;font-weight:bold">--</span><span style="color:#000">restart</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">always</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">p</span> <span style="color:#000">8086</span>:<span style="color:#204a87;font-weight:bold">8086</span> <span style="color:#000">influxdb</span>:<span style="color:#204a87;font-weight:bold">1.8</span>
</span></span></code></pre></div><ol start="2">
<li>Run task service</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span> <span style="color:#a40000">/c/repos/Twin: npm run serve -w taskservice</span>
</span></span></code></pre></div><ol start="3">
<li>Use task <code>pushDummyRealtimeValues</code> to generate dummy data (generate data for 2 sensors )</li>
</ol>
<p>eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">ImportContext</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">from</span> <span style="color:#4e9a06">&#39;@kognitwin/cli&#39;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">async</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">importSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span>: <span style="color:#204a87;font-weight:bold">ImportContext</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importJson</span><span style="color:#000;font-weight:bold">([</span><span style="color:#4e9a06">&#39;test-rt.json&#39;</span><span style="color:#000;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;rt&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">async</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span>: <span style="color:#204a87;font-weight:bold">ImportContext</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">importPipeline</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;rt&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">id</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;cn:test:import:rt&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;Cn Test Rt Import Pipeline&#39;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">tasks</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;push_dummy_realtime_values_emissions&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;task&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;pushDummyRealtimeValues&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;configuration&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:test:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;isTaskRunningDuration&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;seconds&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;intervalinMS&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">30000</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;forLast&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#4e9a06">&#34;minutes&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;tagList&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;tag&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;range&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;min&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;max&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">11</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;tag&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM200-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#4e9a06">&#34;range&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;min&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#4e9a06">&#34;max&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">12</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;fromDate&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;toDate&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>or</p>
<p>run <code>ktw add source</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw add <span style="color:#204a87">source</span> cn:zilong:rt  
</span></span></code></pre></div><p>ref:</p>
<ul>
<li>
<p><a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/import-zilong-rt.ts">import-zilong-rt.ts</a></p>
</li>
<li>
<p><a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-rt.json">zilong-rt.json</a></p>
</li>
</ul>
<p>Could use InfluxDB Studio(I have uploaded to <a href="https://dbinsp.sharepoint.com/:u:/r/sites/KDIASKDIChina-SolutionandDev/Shared%20Documents/Solution%20and%20Dev/11_Dev/Softwares/InfluxDBStudio-0.2.0.zip?csf=1&web=1&e=NjUuSo">Teams</a>, Just unzip and run) to view the data:</p>
<p><img alt="image.png" src="/docs./how%20to%20setup%20timeseries%C2%A0_2023_04_14_12_05_3.png"></p>
<ol start="4">
<li>Register the 2 sensors:</li>
</ol>
<p>eg: test-rta-assets.json</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;assets&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:test:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Realtime&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;data&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;derived&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:test:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM200-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Realtime&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;data&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;derived&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;dataType&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/test-rta-assets.json">test-rta-assets.json</a></p>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ktw import cn<span style="color:#4e9a06">\z</span>ilong<span style="color:#4e9a06">\c</span>n-test-workflows-rt.json   
</span></span></code></pre></div><p><img alt="source cn:zilong:rt in mongodb" src="/docshow%20to%20setup%20timeseries%C2%A0_2023_05_10_14_49_2.png"></p>
<p>5 Import workflow. ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/master/cn/test/cn-test-workflows-rt.json">https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/master/cn/test/cn-test-workflows-rt.json</a></p>
<p>6 Open http://localhost:4200/cn:test:realTime:test:new. result should be like:</p>
<p><img alt="picture 17" src="/docs./how%20to%20setup%20timeseries%C2%A0_2023_04_14_12_05_4.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dd0691b93c7463d6e2988ce25061a4b8">3.18 - how-to-set-camera-focus-prop-in-v3d</h1>
    
	<h3 id="here-shows-how-to-set-the-camera-viewing-distance-and-angles-for-v3d-br">Here shows how to set the camera viewing <code>distance</code> and <code>angles</code> for v3d: <br/></h3>
<p><img alt="picture 1" src="/docshow-to-set-camera-focus-prop-in-v3d_2023_06_02_11_57_1.png"></p>
<p>one example config is like below:
<img alt="picture 2" src="/docshow-to-set-camera-focus-prop-in-v3d_2023_06_02_11_55_0.png">  <br/></p>
<ul>
<li>the <code>distance</code> is in meters.</li>
<li>the <code>angles</code> is Euler, <code>angles[0]</code> is for horizontal, <code>angles[1]</code> is for vertical. default viewing angle is from top down. conversion between degree to Euler is: `EULER = DEGREE / 180 * PI        <a href="https://zhuanlan.zhihu.com/p/85108850">ref</a>
<ul>
<li>set the <code>angles: [0, 1.57]</code> to view from equator</li>
</ul>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c13b1511c5247efb1ff5057480e03c36">3.19 - ktw transfer from dev.poc to dev</h1>
    
	<p>从 dev.poc 迁移所有内容到 dev</p>
<h1 id="assets-v3d-edw-pnid">assets (v3d, edw, pnid)</h1>
<pre><code>run `ktw transfer`cmd. eg:  
```sh
ktw transfer transfer\transfer-todev-assets.json
```

ref: [transfer-todev-assets.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/transfer/transfer-todev-assets.json)
</code></pre>
<h1 id="files">files</h1>
<pre><code>Note: 首先尝试了通过 `ktw transfer` 把 dev.poc 环境中的 `files` 文件下载到本地, eg:  

```json
{
  &quot;source&quot;: &quot;t&quot;,
  &quot;destination&quot;: &quot;local&quot;,
  &quot;defaults&quot;: {
    &quot;sample&quot;: true,
    &quot;batchSize&quot;: 10000
  },
  &quot;data&quot;: {
    &quot;files&quot;: [
      {
        &quot;id&quot;: &quot;assets&quot;,
        &quot;path&quot;: &quot;files/assets/ORM&quot;,
        &quot;overwrite&quot;: true
      }
    ]
  }
}
```

ref: [transfer-tolocal-files.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/transfer/transfer-tolocal-files.json)

在 `environments` 环境变量中， 配置 `filesStorage.root` &amp; `filesStorage.SASKey`, eg:  

```json
{
      &quot;id&quot;: &quot;local&quot;,
      &quot;baseUrl&quot;: &quot;http://localhost:8080&quot;,
      &quot;filesStorage&quot;: {
        &quot;root&quot;: &quot;./files&quot;
      }
    },
```

```json
{
      &quot;id&quot;: &quot;t&quot;,
      &quot;baseUrl&quot;: &quot;https://dev.poc.kognitwin.cn/api&quot;,
      &quot;name&quot;: &quot;t&quot;,
      &quot;type&quot;: &quot;development&quot;,
      &quot;isDefault&quot;: false,
      &quot;oAuthConfig&quot;: {
        &quot;tenantId&quot;: &quot;dev-poc&quot;,
        &quot;clientId&quot;: &quot;twin-devicelogin&quot;,
        &quot;idp&quot;: &quot;keycloak&quot;,
        &quot;clientSecret&quot;: &quot;&quot;,
        &quot;authServerUrl&quot;: &quot;https://auth.ops.kognitwin.cn/&quot;
      },
      &quot;filesStorage&quot;: {
        &quot;root&quot;: &quot;./files&quot;,
        &quot;SASKey&quot;: &quot;&quot;
      }
    },
```

ref: [ktw.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/ktw.json)

run `ktw transfer`cmd. eg:
```sh
ktw transfer transfer\transfer-tolocal-files.json
```

因 SRE 在腾讯云配置 `filesStorage.SASKey` 需要一定的学习成本和时间成本， 所以选择手动把文件服务api(`https://dev.kognitwin.cn/api/files/`)下的文件下载下来
</code></pre>
<h1 id="sources-scenes-workflows-templates">sources, scenes, workflows, templates</h1>
<pre><code>run `ktw transfer`cmd. eg:  
```sh
ktw transfer transfer\transfer-todev-sources.json
ktw transfer transfer\transfer-todev-scenes.json
ktw transfer transfer\transfer-todev-workflows.json
ktw transfer transfer\transfer-todev-templates.json
```

ref: 
- [transfer-todev-sources.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/transfer/transfer-todev-sources.json)
-  [transfer-todev-scenes.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/transfer/transfer-todev-scenes.json)
-  [transfer-todev-workflows.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/transfer/transfer-todev-workflows.json)
-  [transfer-todev-templates.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/transfer/transfer-todev-templates.json)
</code></pre>
<h1 id="reference">reference</h1>
<pre><code>- [ktw transfer](https://internal.docs.kognitwin.com/development/reference/cli/commands/transfer/)


- [Transfer Command](https://internal.docs.kognitwin.com/development/cli/guides/transfer-command/)![picture 0](/docsdeploy%20tencent%20dev_2023_08_02_09_17_3.png)  
</code></pre>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1cb3afda006c016ee681b3ed8d50b107">3.20 - realtime calculator</h1>
    
	<h1 id="teamsrtahulrealtimecalculator-本地功能实现">teams:rta:hul:realtime:calculator 本地功能实现</h1>
<ol>
<li>
<p>copy <code>Twin.KDI\teams\rta</code> folder into <code>Twin.HELLO\teams</code></p>
<p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta">rta folder</a></p>
</li>
<li>
<p>pnid import with linktype</p>
<ol>
<li>
<p>add rta scopes in ktw.json, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;rta&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;rta&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;sources&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hul&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;workflows&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;base&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:base&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.0.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;variant&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;default&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;main&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:main&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.0.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;variant&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;default&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;scopes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hul&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hul&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;sources&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;meta&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:edw&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;edw&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:v3d&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;v3d&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:pnid&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;pnid&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;rt&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:calculation&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;calculation&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;workflows&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;base&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:base&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.0.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;variant&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;default&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;main&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:main&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.0.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;variant&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;default&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/ktw.json">rta scope</a></p>
</li>
<li>
<p>download the pdf file - 2002-HP-Separator and put inside to folder <code>C:\Cogs\KDI\teams\rta\huldra\PnId</code></p>
<p>ref: <a href="https://dbinsp.sharepoint.com/:b:/s/KDIASKDIChina-SolutionandDev/EcqE8W_GZotPtZzIj4zNBQIB9JBvPd8SRu44HBdq6MVxaQ?e=n01jR8">2002-HP-Separator</a></p>
</li>
<li>
<p>download analyzerConfig file - Kdi-Dev-Finder.json and put inside to folder <code>C:\Cogs\KDI\teams\rta\huldra\configs</code></p>
<p>ref: <a href="https://dbinsp.sharepoint.com/:u:/s/KDIASKDIChina-SolutionandDev/Ed7RgHHwjwxAuSTPRNWijO8BsXKZKEHily_YLDis15ppJg?e=Ref7Zx">Kdi-Dev-Finder.json</a></p>
</li>
<li>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s teams:* -t pnid   
</span></span></code></pre></div></li>
<li>
<p>result of pnid import</p>
<p><img alt="picture 0" src="/docsrealtime%20calculator_2023_07_04_09_57_3.png"></p>
</li>
</ol>
</li>
<li>
<p>create realtime bubble (circle shape)</p>
<ol>
<li>
<p>import edw</p>
<ol>
<li>
<p>download 3 excel file - Doc_list.csv, Doc_to_Tag.csv, Tag_list_csv.csv and put inside to folder <code>C:\Cogs\KDI\teams\rta\huldra\EDW</code></p>
<p>ref: <a href="https://dbinsp.sharepoint.com/:x:/s/KDIASKDIChina-SolutionandDev/EXSbrgVNZzxCmx_7iwRTbrgBhlX5sYq8ulzwn85dQ5R1dA?e=W3wGY9">Tag_list_csv.csv</a></p>
<p><a href="https://dbinsp.sharepoint.com/:x:/s/KDIASKDIChina-SolutionandDev/ERIrZlC06GJItpszCwYm58gBpbh1z1fVp_LASyFGHCTjHg?e=bq2LLb">Doc_to_Tag.csv</a></p>
<p><a href="https://dbinsp.sharepoint.com/:x:/s/KDIASKDIChina-SolutionandDev/EVk27N1yVnpFh7QrBYQB0VYB5yaQU-cBGiUGHTIgMu213g?e=XfrSIE">Doc_list.csv</a></p>
</li>
<li>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s teams:* -t edw   
</span></span></code></pre></div></li>
</ol>
</li>
<li>
<p>import rt</p>
<ol>
<li>
<p>download excel file - kspicetags.csv and put inside to folder <code>C:\Cogs\KDI\teams\rta\huldra\RT</code></p>
<p>ref: <a href="https://dbinsp.sharepoint.com/:x:/s/KDIASKDIChina-SolutionandDev/EYjehHj8PcBAvC_EktclzW8BSdIyBpYVcp1ZGRzw4b4Hhg?e=SwNFc1">kspicetags.csv</a></p>
</li>
<li>
<p>run <code>ktw import</code>cmd. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ktw import -s teams:* -t rt   
</span></span></code></pre></div></li>
</ol>
</li>
<li>
<p>Register a sensor, eg: test-rta-assets.json</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;assets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;tag&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;itemType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ANALOG&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;tag&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;#REF!&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;derived&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;dataType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;pathTransform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/1:MyDevice/1:FreeMemory&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;attributes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;key&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;km&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;mappings&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;teams:rta:hul:edw&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;20PT1014&#34;</span><span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;teams:rta:hul:pnid&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;20PT1014_2002-HP-Separator_000_5017_5719&#34;</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;links&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:edw&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;edw&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/hul/test-rta-assets.json">test-rta-assets.json</a></p>
</li>
<li>
<p>opcua config to connect node-opcua server and twin server, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;sources&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;opcUa&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;options&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;broadcast&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;history&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;supportsTimeseriesSubscriptions&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;pathTransform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.derived.pathTransform&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;transform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event.value.value&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event.timestamp.dateFormat(x).num()&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.derived.unit&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;server&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;opcUa&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;endpoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/UA/MyLittleServer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;NodeOPCUA-Client&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;host&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;opc.tcp://localhost:4334&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;influx&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;host&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;localhost&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;database&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams_rta&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;defaultRetentionPolicy&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;twin_default&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;retentionPolicies&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;twin_default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;duration&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;365d&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;replication&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;isDefault&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:calc:value&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:calc:value&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;rtCalc&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;options&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;broadcast&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;history&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;supportsTimeseriesSubscriptions&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;server&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;influx&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;host&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;localhost&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;database&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams_rta_hul_calc&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;defaultRetentionPolicy&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;twin_default&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;retentionPolicies&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;twin_default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;duration&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;365d&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;replication&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;isDefault&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/hul/hul-rt.json">hul-rt.json</a></p>
</li>
<li>
<p>变量说明</p>
<ul>
<li>
<p>timestamp</p>
<p>sources里的timestamp - <code>&quot;timestamp&quot;: &quot;$event.timestamp.dateFormat(x).num()&quot;,</code> 从opcua server读取实时且最新的变量sourceTimestamp。</p>
<p>为了从opcua server产生实时且最新的变量sourceTimestamp，opcua server需要按照callback的方式来添加变量, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#000">namespace</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addVariable</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">componentOf</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">device</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">nodeId</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;s=free_memory&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// a string nodeID
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">browseName</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;FreeMemory&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">dataType</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Double&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">refreshFunc</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">callback</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">sourceTimestamp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Date</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">valueOf</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">sourcePicoseconds</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">dataValue</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DataValue</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Variant</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">dataType</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Double</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">variable1</span> <span style="color:#000;font-weight:bold">}),</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">statusCode</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">StatusCodes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Good</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">sourceTimestamp</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">sourcePicoseconds</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">callback</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">dataValue</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sourceTimestamp</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sourcePicoseconds</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">});</span>
</span></span></code></pre></div><p>opcua server产生实时且最新的变量sourceTimestamp为String类型， eg: <code>&quot;sourceTimestamp&quot;:&quot;2023-06-29T01:21:59.033Z&quot;</code>。 而realtime calculator需要的sourceTimestamp变量为Number类型</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">TimestampedRealtimeValue</span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">T</span> <span style="color:#a40000">=</span> <span style="color:#c4a000">number</span><span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#204a87;font-weight:bold">extends</span> <span style="color:#000">RealtimeValue</span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">T</span><span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// Milliseconds since Unix Epoch (UTC)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">timestamp</span>: <span style="color:#204a87;font-weight:bold">number</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>所以需要通过resolveVariables转换下格式， eg: <code>&quot;timestamp&quot;: &quot;$event.timestamp.dateFormat(x).num()&quot;,</code> -&gt;  <code>timestamp: 1688377751117,</code></p>
</li>
</ul>
</li>
<li>
<p>result of realtime bubble</p>
<p><img alt="picture 1" src="/docsrealtime%20calculator_2023_07_04_14_18_0.png"></p>
</li>
</ol>
</li>
<li>
<p>create calculation 菱形形状</p>
<ol>
<li>import data to influxdb with Postman, eg:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;points&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2023-06-29T03:30:07.847Z&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><ol start="2">
<li>
<p>add search config <code>&quot;teams:rta:hul:edwTag&quot;</code> in Twin.hello\hello-projects.json and restart twin server, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;teams:rta:hul:edwTag&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;query&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:edw&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Tag&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;projection&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;flexDoc&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;field&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;type&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;store&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;source&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#4e9a06">&#34;derived&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;options&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;boostFields&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>Create a calc declaration with UI</p>
<ol>
<li>
<p>click realtime bubble, create formula, click create calculation button</p>
<p><img alt="picture 3" src="/docsrealtime%20calculator_2023_07_04_14_45_3.png"></p>
</li>
<li>
<p>fill in edw tag, name and unit, click add button</p>
<p><img alt="picture 4" src="/docsrealtime%20calculator_2023_07_04_14_49_0.png"></p>
</li>
<li>
<p>result of create a calc declaration</p>
<p><img alt="picture 5" src="/docsrealtime%20calculator_2023_07_04_14_50_0.png"></p>
<p><img alt="picture 6" src="/docsrealtime%20calculator_2023_07_04_14_56_4.png"></p>
<p><img alt="picture 7" src="/docsrealtime%20calculator_2023_07_04_14_57_1.png"></p>
<p><img alt="picture 8" src="/docsrealtime%20calculator_2023_07_04_14_58_3.png"></p>
</li>
</ol>
</li>
<li>
<p>create a new calculation instance with API</p>
<ol>
<li>start calculation service</li>
</ol>
<p>run <code>npm run serve</code>cmd. eg:</p>
<pre><code> ```sh
 Twin\services\calculation&gt; npm run serve   
 ```
</code></pre>
<ol start="2">
<li>
<p>open the api with calculation service swagger doc</p>
<p>ref: <a href="http://localhost:9833/docs/static/index.html#/run/post_v1_run_start__id_">Calculation Service post /v1/run/start/{id}</a></p>
</li>
<li>
<p>fill in the source and id, then click execute button, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;source&#34;</span> <span style="color:#a40000">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:calc:run&#34;</span><span style="color:#a40000">,</span>
</span></span><span style="display:flex;"><span><span style="color:#4e9a06">&#34;id&#34;</span> <span style="color:#a40000">:</span> <span style="color:#4e9a06">&#34;20PST1013:rtcalcdemo&#34;</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><p><img alt="picture 9" src="/docsrealtime%20calculator_2023_07_04_15_13_2.png"></p>
</li>
<li>
<p>result of create a new calculation</p>
<p><img alt="picture 10" src="/docsrealtime%20calculator_2023_07_04_15_16_3.png"></p>
<p><img alt="picture 11" src="/docsrealtime%20calculator_2023_07_04_15_17_1.png"></p>
<p><img alt="picture 12" src="/docsrealtime%20calculator_2023_07_04_15_17_0.png"></p>
</li>
</ol>
</li>
</ol>
</li>
<li>
<p>unit conversion</p>
<ol>
<li>
<p>define input unit and output unit in the sensor assets, <code>derived.unit</code> defined the input unit from OPCUA server. <code>attributes</code> defined the desired output unit. eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;assets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014:MeasuredValue&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;tag&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;itemType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ANALOG&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;tag&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;#REF!&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;derived&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;dataType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;pathTransform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/1:MyDevice/1:FreeMemory&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;attributes&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;key&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;km&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;mappings&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;teams:rta:hul:edw&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;20PT1014&#34;</span><span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;teams:rta:hul:pnid&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;20PT1014_2002-HP-Separator_000_5017_5719&#34;</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;links&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20PT1014&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;teams:rta:hul:edw&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;edw&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/hul/test-rta-assets.json">test-rta-assets.json</a></p>
</li>
<li>
<p>minor change <code>interface.input.units</code> in workflow, eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;interface&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;input&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;names&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$$$sessionContext.formula.variables.map(alias)&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;units&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$$$sessionContext.formula.variables.map(attributes.0.value)&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;output&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;names&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;$$$(parameters.edw.id):$(parameters.name)&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;units&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;$$$_.or($parameters.unit, $undefined)&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/rta-workflows-base.json">rta-workflows-base.json</a></p>
</li>
<li>
<p>在create calculation创建后，calc:def 里面的interface.input.units为期望转换的单位, 已此进行单位转换。 eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;interface&#34;</span> <span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;input&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;names&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#4e9a06">&#34;_20PT1014MeasuredValue&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;units&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#4e9a06">&#34;km&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;output&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;names&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#4e9a06">&#34;20PST1013:tryfixinput&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">&#34;units&#34;</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#4e9a06">&#34;km&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">,</span>
</span></span></code></pre></div></li>
</ol>
</li>
<li>
<p>search timeseires</p>
<p>add search config <code>&quot;teams:rta:hul:rt&quot;</code> in Twin.hello\hello-projects.json and restart twin server, eg:</p>
<pre><code> ```json
 &quot;teams:rta:hul:rt&quot;: {
       &quot;query&quot;: {
         &quot;source&quot;: &quot;teams:rta:hul:rt&quot;,
         &quot;type&quot;: &quot;tag&quot;
       },
       &quot;projection&quot;: [
         &quot;id&quot;,
         &quot;type&quot;,
         &quot;source&quot;,
         &quot;derived&quot;
       ],
       &quot;flexDoc&quot;: {
         &quot;id&quot;: &quot;id&quot;,
         &quot;field&quot;: [
           &quot;id&quot;,
           &quot;type&quot;
         ],
         &quot;store&quot;: [
           &quot;id&quot;,
           &quot;type&quot;,
           &quot;source&quot;,
           &quot;derived&quot;
         ]
       },
       &quot;options&quot;: {
         &quot;boostFields&quot;: {
           &quot;id&quot;: 5
         }
       }
     }
 ```
</code></pre>
<p><img alt="picture 13" src="/docsrealtime%20calculator_2023_07_05_15_40_1.png"></p>
</li>
<li>
<p>乘法脏符号处理</p>
<p>7.1 通过阅读源码，发现已经提供乘法脏符号处理的逻辑</p>
<pre><code> ```ts
 private _defaultSanitization: MathInputSanitization = {
     storage: {
       '∗': '*',
       '≠': '!=',
       '≤': '&lt;=',
       '≥': '&gt;=',
       ':}': ')',
       '{:': '('
     },
     visual: {
       '\\cdot': '\\ast'
     }
   }

   this.model = {
       id,
       name: config.label || 'Value',
       label: config.label || '',
       delay: config.delay ?? 500,
       cssClasses: config.cssClasses,
       readOnly: config.readOnly || false,
       mathFormat: config.mathFormat ?? MathFormat.ASCII_MATH,
       virtualKeyboard: config.virtualKeyboard ?? 'off',
       sanitization: { ...this._defaultSanitization, ...config.sanitization }
     };
 ```

 ref: [math-input.component.ts](&gt;Twin repo\client\projects\twin-components\src\lib\forms\math-input\math-input.component.ts)
</code></pre>
<p>7.2 修改组件配置文件， eg:</p>
<pre><code> ```json
 &quot;defaults&quot;: {
               &quot;formulaDisplayValue&quot;: &quot;&quot;,
               &quot;formulaAlias&quot;: &quot;&quot;,
               &quot;sanitization&quot;: {}
             },
 ```

 ref: [rta-rcd-components.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/teams/rta/templates/components/rta-rcd-components.json)
</code></pre>
</li>
</ol>
<h1 id="reference">reference</h1>
<p><a href="https://kdic.coding.net/p/kdi-twin/d/Twin/git/tree/kdic-0613">twin branch</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/services/calcservice/how_to_run_calcs/">How to run calculations</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/services/calcservice/configuring_calculations/">Calc assets, configuration and importing</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/services/calcservice/local_development/">How to setup a local development environment for calculations</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/services/calcservice/">Calculation service aka CalcService</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/services/calcservice/technical/">Technical overview</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/applications-features/applications/realtimecalculationframework/realtimecalculationframework/#introduction">Real-Time Calculation Framework</a></p>
<p><a href="https://internal.docs.kognitwin.com/docs/reference/ports/">Ports</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e540ef25ef9e18ee85d9656ace2b8280">3.21 - run lng-python-logic 遇到的一些问题记录</h1>
    
	<p>run lng-python-logic 遇到的一些问题记录</p>
<ol>
<li>
<p>run <code>poetry install</code></p>
<p>问题1: python version 不对
当前激活版本： 3.8.0， 实际需要版本： ^3.11</p>
<p><img alt="picture 0" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_16_30_2.png"></p>
<p>问题2： 使用 pyenv 切换 python 版本</p>
<p>查看已经安装的 python 版本 run
<code>pyenv versions</code></p>
</li>
</ol>
<p><img alt="picture 1" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_16_32_1.png"></p>
<pre><code>切换python版本 run
`pyenv global 3.11.0a1`
</code></pre>
<p><img alt="picture 2" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_16_54_3.png"></p>
<pre><code>问题3: 切换到 python 3.11 后仍然报错。因为 poetry 仍然使用本地缓存的虚拟环境运行 cache virtualenvs
</code></pre>
<p><img alt="picture 3" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_17_03_2.png"></p>
<pre><code>找到缓存目录删除后即可
</code></pre>
<p><img alt="picture 4" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_17_05_3.png"></p>
<pre><code>安装成功：
</code></pre>
<p><img alt="picture 5" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_17_06_2.png"></p>
<ol start="2">
<li>
<p>run <code>poetry run main</code></p>
<p>启动成功：</p>
</li>
</ol>
<p><img alt="picture 7" src="/docsrun%20lng-python-logic%20%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95_2024_04_11_17_16_2.png"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-30e2b21c4655c9df48acee02c6541aff">3.22 - switch to realtime view</h1>
    
	<h1 id="switch-to-realtime-view">switch to realtime view</h1>
<ol>
<li>
<p>git clone node-opcua repo to your folder eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>C:<span style="color:#4e9a06">\p</span>rojects&gt; git clone git@github.com:node-opcua/node-opcua.git
</span></span></code></pre></div><blockquote>
<p>ref: <a href="https://github.com/node-opcua/node-opcua">github node-opcua url</a></p>
</blockquote>
</li>
<li>
<p>start opcua server eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>C:<span style="color:#4e9a06">\p</span>rojects<span style="color:#4e9a06">\n</span>ode-opcua&gt;node documentation<span style="color:#4e9a06">\s</span>ample_server.js
</span></span></code></pre></div><blockquote>
<p>ref: <a href="https://github.com/node-opcua/node-opcua/blob/master/documentation/sample_server.js">sample_server.js</a></p>
</blockquote>
</li>
<li>
<p>opcua config to connect node-opcua server and twin server</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;sources&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;opcUa&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;options&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;broadcast&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;history&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;version&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;supportsTimeseriesSubscriptions&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;pathTransform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.derived.pathTransform&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;transform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event.value.value&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.derived.unit&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;server&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;opcUa&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;endpoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/UA/MyLittleServer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;NodeOPCUA-Client&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;host&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;opc.tcp://localhost:4334&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;influx&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;host&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;influxdb&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;database&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;twin&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;defaultRetentionPolicy&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;twin_default&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;retentionPolicies&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;twin_default&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;duration&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;365d&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;replication&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">&#34;isDefault&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>ref: <a href="https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-rt.json">zilong-rt.json</a></p>
</li>
<li>
<p>变量说明</p>
<ul>
<li>
<p>id</p>
<p>sources里的id - <code>&quot;id&quot;: &quot;cn:zilong:rt&quot;</code> 应该与assets里的source保持一致</p>
<p>test-rta-assets.json eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;assets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TOTAL_NOX_EMISSION_SOURCE1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Realtime&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;dataType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;derived&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;kg&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;dataType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;pathTransform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/1:MyDevice/1:FreeMemory&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>type</p>
<p>如果需要使用twin server opcua，则type为opcUa <code>&quot;type&quot;: &quot;opcUa&quot;</code></p>
</li>
<li>
<p>pathTransform - Transform from source asset to data source path</p>
<p>eg:</p>
<p><code>&quot;pathTransform&quot;: &quot;/1:MyDevice/1:FreeMemory&quot;</code></p>
<p><code>/</code>后面的变量分别对应的是opcua server里的<code>namespaceIndex</code> 加 <code>:</code> 加 <code>browseName</code>， eg:
<code>/namespaceIndex:browseName/namespaceIndex:browseName</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">device</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">namespace</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addObject</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">organizedBy</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">addressSpace</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rootFolder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">objects</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">browseName</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;MyDevice&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">namespace</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addVariable</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">componentOf</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">device</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">nodeId</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;s=free_memory&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// a string nodeID
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">browseName</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;FreeMemory&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">dataType</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Double&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">get</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Variant</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">dataType</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Double</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">arrayType</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">available_memory</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">});</span>
</span></span></code></pre></div><p><img alt="picture 3" src="/docsswitch%20to%20realtime%20view_2023_06_14_14_56_4.png"></p>
<p>具体用法参考ref：</p>
<ul>
<li>
<p><a href="https://node-opcua.github.io/api_doc/2.32.0/modules/node_opcua.html#makerelativepath">makeRelativePath</a></p>
</li>
<li>
<p><a href="https://reference.opcfoundation.org/Core/Part4/v105/docs/A">Annex A (informative)BNF definitions</a></p>
</li>
</ul>
</li>
<li>
<p>transform</p>
<p>zilong-rt.json eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;transform&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event.value.value&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$asset.derived.unit&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><p><code>transform.source</code>, <code>transform.id</code>, <code>transform.unit</code> 与 assets里的source, id, unit保持一致。<br>
<code>transform.value</code>的值: <code>&quot;$event.value.value&quot;</code>就是node-opcua server里传过来的数据。具体用法详见 Twin\server\realtime\realtime-opcua.ts:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">resolveVariables</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">source</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">transform</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">asset</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">event</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">id</span>: <span style="color:#204a87;font-weight:bold">asset.id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span>: <span style="color:#204a87;font-weight:bold">dataValue.value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">timestamp</span>: <span style="color:#204a87;font-weight:bold">dataValue.sourceTimestamp</span> <span style="color:#000;font-weight:bold">},</span> <span style="color:#000">source</span> <span style="color:#000;font-weight:bold">});</span>
</span></span></code></pre></div><p>test-rta-assets.json eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;assets&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;TOTAL_NOX_EMISSION_SOURCE1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Realtime&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;m&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;dataType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span> <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;derived&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;kg&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;dataType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;unknown&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;pathTransform&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/1:MyDevice/1:FreeMemory&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>server.opcUa</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;opcUa&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;endpoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;/UA/MyLittleServer&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;applicationName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;NodeOPCUA-Client&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;host&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;opc.tcp://localhost:4334&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>参考opcua server endpoint url 配置</p>
<p><img alt="picture 4" src="/docsswitch%20to%20realtime%20view_2023_06_14_15_17_1.png"></p>
</li>
</ul>
</li>
<li>
<p>click &lsquo;switch to realtime view&rsquo; button to see the result</p>
<p><img alt="picture 1" src="/docsswitch%20to%20realtime%20view_2023_06_12_17_33_1.png"></p>
</li>
<li>
<p>unit conversion (history &amp; realtime)</p>
<p>6.1 switch to history view</p>
<pre><code> set units from and to for unit conversion configuration

 eg:
 ```json
 &quot;average&quot;: {
   &quot;assets&quot;: [
     {
     &quot;source&quot;: &quot;cn:zilong:rt&quot;,
     &quot;id&quot;: &quot;TOTAL_NOX_EMISSION_SOURCE1&quot;,
     &quot;displayName&quot;: &quot;总排放量&quot;
     }
   ],
   &quot;template&quot;: {
     &quot;history&quot;: false,
     &quot;unit&quot;: &quot;kg&quot;,
     &quot;label&quot;: &quot;$asset.displayName&quot;,
     &quot;timeSeriesQuery&quot;: {
     &quot;limit&quot;: 100000,
     &quot;aggregate&quot;: &quot;sum&quot;,
     &quot;interval&quot;: &quot;24h&quot;,
     &quot;units&quot;: {
       &quot;from&quot;: &quot;g&quot;,
       &quot;to&quot;: &quot;kg&quot;
     }
     },
     &quot;fill&quot;: true,
     &quot;borderWidth&quot;: 1,
     &quot;lineTension&quot;: 0
   }
 },
 ```

 ref: [hello-workflows-emission-management.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/master/cn/zilong/hello-workflows-emission-management.json)
</code></pre>
<p>6.2 switch to realtime view</p>
<pre><code> set transform.unit for unit conversion configuration

 eg: in zilong-rt.json
 ```json
 &quot;transform&quot;: {
     &quot;source&quot;: &quot;cn:zilong:rt&quot;,
     &quot;id&quot;: &quot;$asset.id&quot;,
     &quot;value&quot;: &quot;$event.value.value&quot;,
     &quot;unit&quot;: &quot;$asset.derived.unit&quot;
   },
 ```

 ref: [zilong-rt.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/zilong-rt.json)
</code></pre>
</li>
<li>
<p>unit come from opcua server</p>
<p>eg: in zilong-rt.json</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>      <span style="color:#4e9a06">&#34;transform&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;source&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;cn:zilong:rt&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;LAYER_WM100-EQUI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event.value.value.split(:).0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;unit&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;$event.value.value.split(:).1&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span><span style="color:#a40000">,</span>
</span></span></code></pre></div><p>in sample_server.js need to change opcua server value to <code>dataType: &quot;String&quot;,</code>  eg:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">available_memory() {</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8f5902;font-style:italic">// var value = process.memoryUsage().heapUsed / 1000000;
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">percentageMemUsed</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">freemem</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">totalmem</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#0000cf;font-weight:bold">100.0</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">combo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">percentageMemUsed</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;:km&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">combo</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">namespace</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addVariable</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">componentOf</span>: <span style="color:#204a87;font-weight:bold">device</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">nodeId</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;s=free_memory&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// a string nodeID
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">browseName</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;FreeMemory&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">dataType</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">value</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">get</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Variant</span><span style="color:#000;font-weight:bold">({</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">dataType</span>: <span style="color:#204a87;font-weight:bold">DataType.String</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">arrayType</span>: <span style="color:#204a87;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">value</span>: <span style="color:#204a87;font-weight:bold">available_memory</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">});</span>
</span></span></code></pre></div></li>
<li>
<p>multi sensors realtime view</p>
<p>8.1 Register the 2 sensors:</p>
<pre><code> ```json
 {
   &quot;assets&quot;: [
     {
       &quot;source&quot;: &quot;cn:zilong:rt&quot;,
       &quot;id&quot;: &quot;TOTAL_NOX_EMISSION_SOURCE1&quot;,
       &quot;type&quot;: &quot;Realtime&quot;,
       &quot;data&quot;: { &quot;unit&quot;: &quot;m&quot;, &quot;dataType&quot;: &quot;unknown&quot; },
       &quot;derived&quot;: {
         &quot;unit&quot;: &quot;kg&quot;,
         &quot;dataType&quot;: &quot;unknown&quot;,
         &quot;pathTransform&quot;: &quot;/1:MyDevice/1:FreeMemory&quot;
       }
     },
     {
       &quot;source&quot;: &quot;cn:zilong:rt&quot;,
       &quot;id&quot;: &quot;TOTAL_NOX_EMISSION_SOURCE2_HP&quot;,
       &quot;type&quot;: &quot;Realtime&quot;,
       &quot;data&quot;: { &quot;unit&quot;: &quot;m&quot;, &quot;dataType&quot;: &quot;unknown&quot; },
       &quot;derived&quot;: {
         &quot;unit&quot;: &quot;kg&quot;,
         &quot;dataType&quot;: &quot;unknown&quot;,
         &quot;pathTransform&quot;: &quot;/1:MyDevice/1:MyVariable1&quot;
       }
     }
   ]
 }


 ```

 ref: [test-rta-assets.json](https://kdic.coding.net/p/generaltemplate/d/Twin.hello/git/tree/onboarding-zilong/cn/zilong/test-rta-assets.json)
</code></pre>
<p>8.2 add 2 variables in node-opcua server</p>
<pre><code> eg:  

 ```js
 // declare a new object
 const device = namespace.addObject({
     organizedBy: addressSpace.rootFolder.objects,
     browseName: &quot;MyDevice&quot;
 });

 // add some variables
 // add a variable named MyVariable1 to the newly created folder &quot;MyDevice&quot;
 let variable1 = 1;

 // // emulate variable1 changing every 500 ms
 setInterval(() =&gt; {
     variable1 += 1;
 }, 500);

 namespace.addVariable({
     componentOf: device,
     browseName: &quot;MyVariable1&quot;,
     dataType: &quot;Double&quot;,
     value: {
         get: () =&gt; new Variant({ dataType: DataType.Double, value: variable1 })
     }
 });

 const os = require(&quot;os&quot;);
 /**
  * returns the percentage of free memory on the running machine
 * @return {double}
 */
 function available_memory() {
     // var value = process.memoryUsage().heapUsed / 1000000;
     const percentageMemUsed = (os.freemem() / os.totalmem()) * 100.0;
     return percentageMemUsed;
 }
 namespace.addVariable({
     componentOf: device,

     nodeId: &quot;s=free_memory&quot;, // a string nodeID
     browseName: &quot;FreeMemory&quot;,
     dataType: &quot;Double&quot;,
     value: {
         get: () =&gt; new Variant({
             dataType: DataType.Double,
             arrayType: 0,
             value: available_memory()
         })
     }
 });
 ```
</code></pre>
<p>8.3 results</p>
<pre><code> ![picture 2](/docsswitch%20to%20realtime%20view_2023_06_13_09_51_3.png)  
</code></pre>
</li>
</ol>
<h1 id="reference">reference</h1>
<p><a href="https://internal.docs.kognitwin.com/docs/development/realtime_and_analytics/realtime-timeseries/subscribing_to_realtime/">How to subscribe to a realtime signal​</a></p>
<p><a href="https://www.opc-router.com/what-is-opc-ua/">OPC UA</a></p>
<p><a href="https://studio3t.com/academy/lessons/mongodb-crud-operations/">Performing MongoDB CRUD Operations</a></p>

</div>



    
	
  

    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        
      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.js"></script>
<script defer src="/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
